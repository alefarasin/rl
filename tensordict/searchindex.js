Search.setIndex({"docnames": ["distributed", "fx", "index", "overview", "reference/generated/tensordict.LazyStackedTensorDict", "reference/generated/tensordict.MemmapTensor", "reference/generated/tensordict.PersistentTensorDict", "reference/generated/tensordict.SubTensorDict", "reference/generated/tensordict.TensorDict", "reference/generated/tensordict.dense_stack_tds", "reference/generated/tensordict.is_batchedtensor", "reference/generated/tensordict.is_memmap", "reference/generated/tensordict.is_tensor_collection", "reference/generated/tensordict.make_tensordict", "reference/generated/tensordict.merge_tensordicts", "reference/generated/tensordict.nn.EnsembleModule", "reference/generated/tensordict.nn.ProbabilisticTensorDictModule", "reference/generated/tensordict.nn.TensorDictModule", "reference/generated/tensordict.nn.TensorDictModuleBase", "reference/generated/tensordict.nn.TensorDictModuleWrapper", "reference/generated/tensordict.nn.TensorDictParams", "reference/generated/tensordict.nn.TensorDictSequential", "reference/generated/tensordict.nn.biased_softplus", "reference/generated/tensordict.nn.dispatch", "reference/generated/tensordict.nn.get_functional", "reference/generated/tensordict.nn.inv_softplus", "reference/generated/tensordict.nn.is_functional", "reference/generated/tensordict.nn.make_functional", "reference/generated/tensordict.nn.make_tensordict", "reference/generated/tensordict.nn.repopulate_module", "reference/generated/tensordict.nn.set_interaction_type", "reference/generated/tensordict.nn.set_skip_existing", "reference/generated/tensordict.nn.skip_existing", "reference/generated/tensordict.pad", "reference/generated/tensordict.pad_sequence", "reference/generated/tensordict.prototype.symbolic_trace", "reference/generated/tensordict.utils.expand_as_right", "reference/generated/tensordict.utils.expand_right", "reference/generated/tutorials/README", "reference/index", "reference/nn", "reference/prototype", "reference/tensordict", "saving", "tutorials/data_fashion", "tutorials/index", "tutorials/sg_execution_times", "tutorials/tensorclass_fashion", "tutorials/tensorclass_imagenet", "tutorials/tensordict_keys", "tutorials/tensordict_memory", "tutorials/tensordict_module", "tutorials/tensordict_module_functional", "tutorials/tensordict_preallocation", "tutorials/tensordict_shapes", "tutorials/tensordict_slicing"], "filenames": ["distributed.rst", "fx.rst", "index.rst", "overview.rst", "reference/generated/tensordict.LazyStackedTensorDict.rst", "reference/generated/tensordict.MemmapTensor.rst", "reference/generated/tensordict.PersistentTensorDict.rst", "reference/generated/tensordict.SubTensorDict.rst", "reference/generated/tensordict.TensorDict.rst", "reference/generated/tensordict.dense_stack_tds.rst", "reference/generated/tensordict.is_batchedtensor.rst", "reference/generated/tensordict.is_memmap.rst", "reference/generated/tensordict.is_tensor_collection.rst", "reference/generated/tensordict.make_tensordict.rst", "reference/generated/tensordict.merge_tensordicts.rst", "reference/generated/tensordict.nn.EnsembleModule.rst", "reference/generated/tensordict.nn.ProbabilisticTensorDictModule.rst", "reference/generated/tensordict.nn.TensorDictModule.rst", "reference/generated/tensordict.nn.TensorDictModuleBase.rst", "reference/generated/tensordict.nn.TensorDictModuleWrapper.rst", "reference/generated/tensordict.nn.TensorDictParams.rst", "reference/generated/tensordict.nn.TensorDictSequential.rst", "reference/generated/tensordict.nn.biased_softplus.rst", "reference/generated/tensordict.nn.dispatch.rst", "reference/generated/tensordict.nn.get_functional.rst", "reference/generated/tensordict.nn.inv_softplus.rst", "reference/generated/tensordict.nn.is_functional.rst", "reference/generated/tensordict.nn.make_functional.rst", "reference/generated/tensordict.nn.make_tensordict.rst", "reference/generated/tensordict.nn.repopulate_module.rst", "reference/generated/tensordict.nn.set_interaction_type.rst", "reference/generated/tensordict.nn.set_skip_existing.rst", "reference/generated/tensordict.nn.skip_existing.rst", "reference/generated/tensordict.pad.rst", "reference/generated/tensordict.pad_sequence.rst", "reference/generated/tensordict.prototype.symbolic_trace.rst", "reference/generated/tensordict.utils.expand_as_right.rst", "reference/generated/tensordict.utils.expand_right.rst", "reference/generated/tutorials/README.rst", "reference/index.rst", "reference/nn.rst", "reference/prototype.rst", "reference/tensordict.rst", "saving.rst", "tutorials/data_fashion.rst", "tutorials/index.rst", "tutorials/sg_execution_times.rst", "tutorials/tensorclass_fashion.rst", "tutorials/tensorclass_imagenet.rst", "tutorials/tensordict_keys.rst", "tutorials/tensordict_memory.rst", "tutorials/tensordict_module.rst", "tutorials/tensordict_module_functional.rst", "tutorials/tensordict_preallocation.rst", "tutorials/tensordict_shapes.rst", "tutorials/tensordict_slicing.rst"], "titles": ["TensorDict in distributed settings", "Tracing TensorDictModule", "Welcome to the TensorDict Documentation!", "Overview", "LazyStackedTensorDict", "MemmapTensor", "PersistentTensorDict", "SubTensorDict", "TensorDict", "dense_stack_tds", "is_batchedtensor", "is_memmap", "is_tensor_collection", "make_tensordict", "merge_tensordicts", "tensordict.nn.EnsembleModule", "ProbabilisticTensorDictModule", "TensorDictModule", "TensorDictModuleBase", "TensorDictModuleWrapper", "tensordict.nn.TensorDictParams", "TensorDictSequential", "tensordict.nn.biased_softplus", "tensordict.nn.dispatch", "tensordict.nn.get_functional", "tensordict.nn.inv_softplus", "tensordict.nn.is_functional", "tensordict.nn.make_functional", "tensordict.nn.make_tensordict", "tensordict.nn.repopulate_module", "tensordict.nn.set_interaction_type", "tensordict.nn.set_skip_existing", "tensordict.nn.skip_existing", "pad", "pad_sequence", "tensordict.prototype.symbolic_trace", "expand_as_right", "expand_right", "README Tutos", "API Reference", "tensordict.nn package", "tensorclass prototype", "tensordict package", "Saving TensorDict and tensorclass objects", "Using TensorDict for datasets", "README Tutos", "Computation times", "Using tensorclasses for datasets", "Batched data loading with tensorclasses", "Manipulating the keys of a TensorDict", "Simplifying PyTorch Memory Management with TensorDict", "TensorDictModule", "Functionalizing TensorDictModule", "Pre-allocating memory with TensorDict", "Manipulating the shape of a TensorDict", "Slicing, Indexing, and Masking"], "terms": {"can": [0, 1, 2, 3, 4, 6, 7, 8, 13, 16, 17, 18, 21, 23, 24, 28, 31, 40, 41, 43, 44, 47, 48, 49, 50, 51, 52, 54, 55], "us": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 13, 16, 17, 18, 20, 21, 23, 24, 28, 30, 31, 40, 42, 45, 46, 48, 49, 50, 52, 53, 54, 55], "pass": [0, 1, 3, 4, 6, 7, 8, 9, 12, 16, 17, 19, 21, 22, 23, 40, 42, 43, 44, 47, 50], "from": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 15, 16, 17, 18, 20, 21, 23, 28, 31, 33, 40, 41, 42, 43, 44, 47, 49, 50, 51, 52, 53, 54, 55], "one": [0, 2, 3, 4, 6, 7, 8, 16, 17, 18, 19, 23, 31, 40, 43, 44, 47, 48, 49, 50, 51, 52, 54, 55], "anoth": [0, 3, 4, 5, 6, 7, 8, 17, 23, 36, 49, 54], "If": [0, 3, 4, 5, 6, 7, 8, 9, 13, 15, 16, 17, 18, 20, 21, 22, 23, 27, 28, 31, 42, 43, 50, 51, 54], "two": [0, 3, 4, 6, 7, 8, 16, 33, 42, 43, 44, 47, 48, 51, 52, 55], "have": [0, 3, 4, 5, 6, 7, 8, 9, 13, 15, 21, 23, 28, 31, 40, 41, 42, 43, 50, 51, 53, 54, 55], "access": [0, 3, 5, 6, 18, 42, 49, 54], "share": [0, 4, 5, 6, 7, 8, 52, 54, 55], "physic": [0, 5, 42, 48], "storag": [0, 3, 4, 5, 6, 7, 8, 42, 48], "effici": [0, 3, 42, 44, 47, 48, 49], "data": [0, 2, 3, 4, 5, 6, 7, 8, 12, 13, 15, 17, 28, 34, 40, 41, 42, 43, 44, 45, 46, 47, 52], "run": [0, 16, 19, 21, 23, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "process": [0, 3, 4, 5, 6, 7, 8, 42, 48], "here": [0, 3, 40, 41, 43, 47, 48], "we": [0, 1, 3, 4, 6, 7, 8, 13, 15, 16, 17, 18, 21, 28, 40, 43, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "provid": [0, 3, 4, 5, 6, 7, 8, 9, 21, 23, 34, 36, 40, 44, 47, 48, 49, 50, 51], "some": [0, 3, 4, 6, 7, 8, 9, 16, 21, 33, 43, 47, 48, 51], "detail": 0, "how": [0, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "thi": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 13, 15, 16, 18, 19, 20, 21, 23, 24, 28, 31, 40, 41, 43, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "achiev": [0, 4, 49, 51], "rpc": 0, "For": [0, 2, 3, 4, 5, 6, 8, 27, 33, 40, 43, 48, 49, 50, 51, 52, 55], "more": [0, 1, 2, 3, 17, 41, 44, 47, 48, 51, 54], "check": [0, 1, 4, 6, 7, 8, 12, 26, 31, 41, 43, 48, 50], "offici": 0, "pytorch": [0, 2, 3, 6, 40, 42, 44, 45, 46, 47], "document": [0, 41], "arrai": [0, 5, 8, 42, 48, 53], "great": 0, "advantag": [0, 3, 6, 40, 42, 43, 48, 53], "thei": [0, 3, 4, 6, 7, 8, 9, 17, 20, 21, 31, 40, 43, 47, 48, 50, 51, 53, 54], "store": [0, 3, 4, 5, 6, 7, 8, 18, 42, 43, 44, 47, 49, 50, 53], "amount": 0, "allow": [0, 3, 4, 6, 7, 8, 23, 31, 40, 41, 42, 43, 44, 47, 48, 50, 51], "slice": [0, 2, 3, 4, 6, 7, 8, 45, 46, 54], "readili": 0, "without": [0, 2, 3, 4, 5, 6, 7, 8, 43], "read": [0, 1, 2, 3, 6, 8, 16, 17, 18, 21, 23, 40, 42, 51, 52], "whole": [0, 43], "file": [0, 4, 5, 6, 7, 8, 42, 43, 46, 48, 50], "offer": [0, 3, 42, 43, 44, 47, 48], "an": [0, 1, 3, 4, 6, 7, 8, 9, 11, 12, 13, 15, 16, 17, 18, 21, 23, 28, 40, 41, 42, 43, 44, 47, 48, 49, 50, 51, 53, 54], "interfac": [0, 5, 6, 51], "between": [0, 4, 5, 6, 7, 8, 16, 42, 51], "torch": [0, 1, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18, 20, 21, 23, 25, 27, 28, 31, 33, 34, 36, 37, 40, 41, 42, 43, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "class": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 30, 31, 33, 34, 36, 37, 40, 41, 42, 43, 44, 47, 48, 50, 51, 52], "name": [0, 2, 4, 6, 7, 8, 17, 20, 23, 31, 40, 51], "memmaptensor": [0, 2, 4, 6, 7, 8, 11, 36, 37, 42, 44, 47, 48, 50], "instanc": [0, 2, 3, 4, 5, 6, 7, 8, 11, 16, 17, 19, 20, 21, 23, 34, 40, 42, 48, 51, 54], "object": [0, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 16, 17, 19, 41, 42, 44, 47, 51, 54], "repres": [0, 3, 4, 5, 6, 7, 8, 16, 20, 51, 55], "big": [0, 2, 42], "dataset": [0, 2, 3, 42, 45, 46, 48], "disk": [0, 6, 8, 42, 43, 44, 47, 48, 50], "easili": [0, 2, 3, 40, 43], "batch": [0, 2, 3, 4, 6, 7, 8, 13, 23, 28, 33, 44, 45, 46, 47, 50, 52, 55], "wai": [0, 3, 4, 6, 7, 8, 40, 42, 43, 48, 49, 54, 55], "A": [0, 3, 4, 5, 6, 7, 8, 15, 16, 17, 18, 21, 22, 31, 33, 35, 40, 48], "simpli": [0, 1, 3, 43, 48, 49, 52, 54], "via": [0, 3, 8, 18], "1": [0, 1, 3, 4, 5, 6, 7, 8, 9, 15, 17, 18, 20, 21, 22, 23, 33, 40, 41, 43, 44, 47, 48, 49, 53, 54, 55], "popul": [0, 3, 8, 17, 40, 43, 44, 50, 53], "2": [0, 1, 3, 4, 5, 6, 7, 8, 9, 15, 17, 18, 21, 23, 33, 34, 40, 41, 44, 47, 48, 49, 52, 53, 54, 55], "call": [0, 3, 4, 6, 7, 8, 9, 16, 17, 19, 21, 23, 26, 30, 31, 40, 43, 51, 52, 53, 54], "memmap_": [0, 4, 6, 7, 8, 43, 48, 50], "put": [0, 4, 6, 7, 8, 43], "One": [0, 3, 17, 40, 41, 43, 48, 51], "queri": [0, 3, 4, 6, 7, 8, 21, 51], "is_memmap": [0, 4, 6, 7, 8, 48], "itself": [0, 18, 50], "done": [0, 3, 4, 6, 7, 8, 40, 41, 44, 47, 48, 54], "sever": [0, 40, 42, 43], "firstli": 0, "empti": [0, 3, 4, 6, 7, 8, 53], "shape": [0, 2, 3, 4, 6, 7, 8, 9, 13, 15, 17, 18, 20, 21, 28, 31, 33, 34, 36, 37, 40, 41, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 55], "size": [0, 3, 4, 5, 6, 7, 8, 9, 13, 15, 16, 17, 18, 20, 21, 23, 28, 31, 33, 34, 36, 37, 40, 41, 43, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "3": [0, 3, 4, 5, 6, 7, 8, 9, 13, 15, 16, 17, 18, 20, 21, 28, 33, 34, 36, 37, 40, 41, 42, 43, 44, 47, 48, 49, 52, 53, 54, 55], "4": [0, 3, 4, 5, 6, 7, 8, 9, 13, 15, 16, 17, 20, 21, 28, 33, 34, 36, 37, 40, 41, 44, 47, 48, 52, 53, 54, 55], "5": [0, 3, 4, 6, 7, 8, 15, 36, 37, 41, 44, 47, 51, 52, 54, 55], "prefix": [0, 4, 5, 6, 7, 8, 43, 50], "tmp": [0, 43], "randn": [0, 1, 3, 4, 6, 7, 8, 13, 15, 16, 17, 20, 21, 28, 40, 41, 43, 51, 52], "The": [0, 2, 3, 4, 6, 7, 8, 9, 15, 16, 17, 18, 20, 21, 22, 23, 33, 40, 41, 42, 43, 44, 47, 48, 49, 50, 51, 54, 55], "attribut": [0, 3, 4, 6, 7, 8, 16, 18, 20, 23, 31, 41, 47, 50, 51, 54], "indic": [0, 4, 5, 6, 7, 8, 18, 22, 23, 31, 44, 47, 51, 55], "where": [0, 3, 4, 5, 6, 7, 8, 16, 18, 23, 34, 40, 43, 50, 51, 54], "temporari": [0, 5, 50], "ha": [0, 3, 4, 5, 6, 7, 8, 9, 16, 26, 33, 40, 43, 48, 49, 51, 52, 53, 54], "It": [0, 3, 4, 5, 6, 7, 8, 16, 18, 34, 40, 41, 51, 54], "crucial": 0, "directori": [0, 4, 6, 7, 8, 43, 50], "everi": [0, 8, 16, 19], "option": [0, 4, 5, 6, 7, 8, 9, 13, 16, 18, 21, 23, 27, 28, 31, 33, 34, 41, 43], "exist": [0, 2, 4, 6, 7, 8, 31, 32, 54], "former": [0, 3, 16, 19], "method": [0, 3, 4, 6, 7, 8, 16, 17, 18, 19, 21, 23, 27, 31, 40, 41, 43, 44, 47, 48, 49, 50, 51, 54], "prefer": [0, 23, 50], "when": [0, 3, 4, 6, 7, 8, 9, 16, 17, 18, 21, 22, 23, 30, 31, 42, 43, 47, 48, 49, 50, 51, 54, 55], "ar": [0, 3, 4, 6, 7, 8, 9, 15, 16, 17, 18, 19, 20, 21, 23, 31, 40, 41, 42, 43, 47, 48, 49, 50, 51, 53, 54, 55], "do": [0, 3, 4, 6, 7, 8, 31, 43, 48, 49], "fit": [0, 42, 43], "suitabl": [0, 43], "extrem": [0, 43], "serv": 0, "common": [0, 4, 5, 6, 7, 8, 23, 48, 54, 55], "could": [0, 4, 6, 7, 8, 43, 48, 49, 55], "would": [0, 3, 4, 6, 8, 9, 42, 50, 51, 52, 55], "singl": [0, 1, 3, 4, 6, 7, 8, 17, 21, 23, 43, 48, 51, 52, 53, 54], "differ": [0, 4, 6, 7, 8, 13, 20, 21, 28, 41, 42, 48, 50, 54], "much": [0, 3, 4, 6, 7, 8, 42, 47, 48, 49, 54], "faster": [0, 3, 42], "than": [0, 3, 17, 33, 42, 43, 44, 47, 48, 51, 54], "each": [0, 1, 2, 3, 4, 6, 7, 8, 21, 27, 40, 43, 44, 47, 48, 49, 51, 54, 55], "had": [0, 54], "load": [0, 2, 5, 6, 42, 44, 45, 46, 47, 50], "independ": [0, 8, 42, 43], "imag": [0, 3, 42, 44, 47, 48], "50000": 0, "480": [0, 42], "mask": [0, 1, 2, 3, 4, 6, 7, 8, 34, 40, 45, 46], "dtype": [0, 3, 4, 5, 6, 7, 8, 9, 13, 15, 16, 17, 18, 20, 21, 28, 31, 34, 40, 41, 42, 43, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "bool": [0, 4, 5, 6, 7, 8, 15, 16, 20, 21, 23, 27, 31, 34, 41, 48], "label": [0, 44, 47], "uint8": [0, 3, 48], "batch_siz": [0, 3, 4, 6, 7, 8, 9, 12, 13, 15, 16, 17, 18, 20, 21, 28, 31, 33, 34, 40, 41, 43, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "devic": [0, 2, 3, 4, 5, 6, 7, 8, 9, 13, 15, 16, 17, 18, 20, 21, 28, 31, 34, 40, 41, 43, 44, 47, 48, 49, 51, 52, 53, 54, 55], "cpu": [0, 4, 5, 6, 7, 8, 9, 13, 15, 17, 18, 20, 21, 28, 31, 34, 40, 41, 43, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "idx": [0, 3, 4, 6, 7, 8, 48], "5020": 0, "34572": 0, "11200": 0, "clone": [0, 4, 5, 6, 7, 8, 9, 17, 18, 41, 54], "field": [0, 4, 6, 7, 8, 9, 13, 15, 16, 17, 18, 20, 21, 28, 31, 34, 40, 43, 44, 49, 50, 51, 52, 53, 54, 55], "float32": [0, 4, 6, 7, 8, 9, 13, 15, 16, 17, 18, 20, 21, 28, 31, 34, 40, 41, 43, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "is_shar": [0, 4, 6, 7, 8, 9, 13, 15, 16, 17, 18, 20, 21, 28, 31, 34, 40, 41, 43, 44, 47, 49, 50, 51, 52, 53, 54, 55], "fals": [0, 4, 5, 6, 7, 8, 9, 12, 13, 15, 16, 17, 18, 20, 21, 27, 28, 31, 34, 40, 41, 43, 44, 47, 49, 50, 51, 52, 53, 54, 55], "notic": [0, 3, 4, 6, 7, 8], "syntax": [0, 3, 49, 55], "sugar": 0, "directli": [0, 9, 17, 42, 43, 44, 47, 48, 49], "need": [0, 3, 9, 16, 19, 23, 40, 41, 42, 43, 44, 47, 48, 51, 54, 55], "consider": 0, "take": [0, 3, 6, 15, 16, 19, 21, 31, 40, 43, 44, 47, 48, 51, 52, 53], "account": 0, "current": [0, 3, 4, 5, 6, 7, 8, 40, 44, 47, 50], "compat": [0, 3, 4, 6, 7, 8, 13, 28, 34, 40, 51, 55], "autograd": 0, "simpl": [0, 3, 16, 44, 47, 52], "exampl": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 15, 16, 17, 18, 20, 21, 23, 28, 31, 33, 34, 36, 37, 40, 41, 42, 43, 44, 45, 47, 48, 49, 50, 52, 53, 54, 55], "script": [0, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "send": [0, 3, 4, 6, 7, 8, 50], "its": [0, 3, 5, 8, 13, 15, 16, 17, 18, 27, 28, 29, 40, 41, 42, 43, 47, 51, 54], "refer": [0, 2, 4, 6, 7, 8, 42, 55], "worker": [0, 3, 4, 5, 6, 7, 8, 42, 48], "respons": [0, 5, 6, 51], "updat": [0, 3, 4, 6, 7, 8, 16, 18, 43, 48, 51, 53, 54, 55], "you": [0, 1, 3, 15, 41, 42, 43, 47, 49, 50, 51, 52, 53, 54, 55], "find": [0, 51], "benchmark": [0, 48], "In": [0, 1, 3, 4, 6, 7, 8, 9, 17, 21, 23, 40, 43, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "short": 0, "our": [0, 3, 44, 47, 48, 51], "goal": 0, "show": [0, 9, 40, 48, 51, 52], "handl": [0, 2, 3, 40, 42, 44, 47], "write": [0, 1, 2, 3, 4, 6, 7, 8, 16, 17, 21, 40, 43, 47, 48, 51, 52], "step": [0, 2, 3, 16, 44, 47, 48, 53, 54], "involv": [0, 4, 6, 8], "local": 0, "remot": [0, 5], "execut": [0, 1, 3, 4, 6, 7, 8, 21, 31, 43, 46, 51, 52], "command": [0, 43], "first": [0, 3, 4, 6, 7, 8, 9, 16, 23, 33, 40, 41, 42, 43, 44, 48, 51, 53, 54, 55], "function": [0, 2, 4, 6, 7, 8, 9, 13, 15, 16, 17, 18, 19, 21, 23, 24, 25, 27, 28, 39, 41, 44, 45, 46, 47, 51, 53, 54, 55], "specif": [0, 4, 6, 8, 17], "fill": [0, 4, 6, 7, 8, 33, 53], "def": [0, 1, 3, 4, 6, 7, 8, 20, 23, 31, 40, 41, 44, 47, 48, 51, 52, 53], "fill_tensordict": 0, "memmap": [0, 4, 5, 6, 7, 8, 43, 44, 47, 50], "ones": [0, 3, 4, 5, 6, 7, 8, 17, 18, 23, 33, 41, 49, 55], "640": 0, "return": [0, 1, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 16, 17, 18, 21, 22, 23, 24, 27, 28, 31, 32, 33, 34, 36, 37, 40, 41, 42, 43, 44, 47, 48, 49, 51, 52, 53, 54, 55], "fill_tensordict_cp": 0, "cloudpicklewrapp": 0, "ensur": [0, 48], "serializ": 0, "next": [0, 48, 54], "make": [0, 2, 3, 4, 6, 8, 15, 16, 40, 41, 43, 48, 49, 51, 52, 55], "point": [0, 3, 4, 6, 7, 8, 23, 40], "hard": 0, "through": [0, 3, 16, 21, 22, 23, 40, 48, 51, 53], "regular": [0, 3, 4, 6, 7, 8, 16, 17, 42, 48, 51, 52, 54, 55], "tensorpip": 0, "1000": [0, 3, 16], "final": [0, 3, 4, 6, 7, 8, 40, 43], "still": [0, 6, 7, 18, 27, 49, 50], "main": [0, 2, 16, 42, 43], "been": [0, 5, 8, 26, 40, 43, 49, 50, 53], "written": [0, 3, 4, 6, 7, 8, 16, 17, 18, 23, 34, 51, 53, 55], "6": [0, 3, 4, 6, 7, 8, 33, 41, 44, 47, 48, 51, 54, 55], "7": [0, 4, 6, 7, 8, 47], "998": 0, "t0": [0, 44, 47, 48], "time": [0, 3, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "out": [0, 1, 3, 4, 5, 6, 7, 8, 13, 17, 28, 31, 34, 40, 48, 51], "rpc_sync": 0, "worker_info": 0, "arg": [0, 1, 3, 4, 6, 7, 8, 15, 16, 17, 18, 19, 20, 21, 31, 40], "print": [0, 1, 3, 4, 6, 7, 8, 13, 16, 17, 20, 21, 23, 28, 31, 33, 34, 36, 37, 40, 41, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "elaps": 0, "all": [0, 1, 3, 4, 5, 6, 7, 8, 9, 16, 19, 21, 23, 30, 31, 33, 40, 41, 42, 43, 45, 49, 50, 51, 53, 54, 55], "although": [0, 16, 19], "entir": [0, 1, 4, 6, 7, 8, 43, 47, 48], "origin": [0, 3, 4, 6, 7, 8, 16, 18, 40, 43, 49, 50, 54, 55], "snippet": 0, "fast": [0, 6, 43, 50], "even": [0, 3, 17, 33, 41, 48, 54], "so": [0, 4, 6, 7, 8, 21, 33, 43, 44, 47, 48, 49, 54, 55], "locat": [0, 4, 5, 6, 7, 8, 43, 50], "alreadi": [0, 4, 6, 7, 8, 15, 16, 31, 43, 44, 47, 49], "beforehand": 0, "see": [0, 4, 6, 7, 8, 31, 47, 48, 49, 50, 51, 54], "torchrl": [0, 3, 15, 40], "s": [0, 3, 15, 16, 21, 31, 40, 43, 44, 47, 48, 54], "replai": 0, "buffer": [0, 4, 6, 7, 8, 17, 20, 21, 40, 52], "learn": [0, 48, 49, 50, 51, 52, 53, 54, 55], "contain": [0, 3, 4, 6, 7, 8, 12, 17, 19, 20, 23, 34, 40, 43, 44, 47, 48, 49, 51, 53, 54], "addit": [0, 3, 4, 6, 7, 8, 40, 48, 54], "configur": 0, "beyond": 0, "purpos": [0, 2, 3, 40], "support": [1, 3, 4, 5, 6, 7, 8, 17, 18, 20, 21, 41, 43, 48, 50, 51, 54], "creat": [1, 2, 3, 4, 5, 6, 7, 8, 13, 16, 17, 19, 21, 28, 34, 43, 44, 47, 48, 49, 50, 51, 52, 54, 55], "fx": 1, "graph": [1, 3, 18, 31, 40], "import": [1, 3, 4, 6, 7, 8, 9, 15, 16, 17, 18, 20, 21, 31, 33, 40, 41, 43, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "symbolic_trac": [1, 40], "tensordict": [1, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 21, 33, 34, 36, 37, 39, 41, 45, 46, 47, 48, 51, 52, 55], "prototyp": [1, 2, 39, 40, 43, 47, 48], "instead": [1, 3, 4, 6, 8, 9, 16, 19, 23, 41, 48, 51, 54, 55], "highli": [1, 2], "experiment": [1, 16], "subject": 1, "chang": [1, 4, 5, 6, 7, 8, 18, 20, 21, 31, 41, 49], "caution": 1, "rais": [1, 4, 6, 7, 8, 43], "issu": [1, 41], "try": [1, 23, 54], "encount": 1, "problem": [1, 3, 40], "ll": [1, 44, 47, 48, 52], "illustr": 1, "overview": [1, 2], "inspect": 1, "gener": [1, 2, 3, 4, 6, 7, 8, 23, 44, 45, 47, 48, 49, 50, 51, 52, 53, 54, 55], "code": [1, 2, 3, 4, 6, 7, 8, 21, 31, 40, 43, 44, 45, 47, 48, 49, 50, 51, 52, 53, 54, 55], "nn": [1, 3, 4, 6, 7, 8, 16, 17, 18, 19, 21, 34, 39, 41, 44, 47, 48, 49, 51, 52], "net": [1, 3, 15, 16, 18, 40, 44, 47, 51], "modul": [1, 2, 3, 4, 6, 7, 8, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 26, 27, 29, 31, 32, 40, 42, 44, 47, 48, 49, 51, 52], "__init__": [1, 3, 20, 40, 44, 47, 48, 51, 52], "self": [1, 3, 4, 6, 7, 8, 18, 20, 23, 31, 40, 41, 44, 47, 48, 51, 52], "super": [1, 3, 20, 40, 44, 47, 48, 51, 52], "linear": [1, 3, 15, 18, 20, 21, 40, 44, 47, 49, 51, 52], "lazylinear": [1, 3], "forward": [1, 3, 16, 17, 18, 19, 21, 23, 27, 31, 33, 40, 44, 47, 48, 51, 52], "x": [1, 3, 4, 5, 6, 7, 8, 17, 18, 21, 40, 41, 43, 44, 47, 48, 51, 52], "logit": [1, 3, 44, 47], "sigmoid": [1, 3], "in_kei": [1, 3, 15, 16, 17, 18, 21, 23, 31, 40, 51, 52], "input": [1, 3, 4, 6, 7, 8, 9, 12, 13, 15, 16, 17, 18, 21, 23, 28, 31, 36, 40, 47, 52], "out_kei": [1, 3, 15, 16, 17, 18, 21, 23, 31, 40, 51, 52], "output": [1, 3, 16, 17, 18, 21, 23, 31, 34, 40, 41, 52], "probabl": [1, 3, 16, 40, 51], "graph_modul": 1, "user": [1, 3, 4, 6, 7, 8, 31, 40, 41, 51], "placehold": 1, "target": [1, 4, 6, 7, 8, 36, 37, 40, 44, 47, 48], "getitem": 1, "call_funct": 1, "oper": [1, 2, 3, 4, 5, 6, 7, 8, 17, 19, 20, 41, 43, 48, 49, 51, 52, 54], "kwarg": [1, 3, 4, 6, 7, 8, 13, 15, 16, 17, 18, 19, 20, 21, 23, 28, 31, 40], "call_modul": 1, "none": [1, 3, 4, 5, 6, 7, 8, 9, 13, 15, 16, 17, 18, 20, 21, 24, 27, 28, 30, 31, 34, 40, 41, 43, 47, 48, 49, 50, 51, 52, 53, 54, 55], "result": [1, 4, 6, 7, 8, 20, 21, 23, 41, 53, 54], "same": [1, 4, 5, 6, 7, 8, 9, 18, 31, 41, 42, 44, 47, 48, 49, 50, 51, 53, 54, 55], "32": [1, 3, 4, 6, 7, 8, 15, 40, 48], "100": [1, 3, 40, 44, 47, 48, 49], "module_out": 1, "tensordict_out": [1, 16, 17, 18, 21, 51], "graph_module_out": 1, "assert": [1, 3, 4, 5, 6, 7, 8, 17, 20, 23, 41, 43, 49, 51, 53, 54, 55], "also": [1, 3, 8, 13, 16, 17, 18, 20, 21, 23, 28, 31, 40, 41, 43, 44, 47, 48, 49, 50, 51, 52, 54, 55], "case": [1, 2, 3, 4, 6, 7, 8, 9, 16, 17, 21, 39, 42, 47, 48, 49, 51, 54, 55], "elimin": [1, 48], "intermedi": [1, 3, 18, 40], "demonstr": [1, 44, 47, 48, 51, 53], "sequenti": [1, 3, 15, 18, 20, 21, 40, 44, 47, 48, 49, 51], "input_s": [1, 3, 40], "hidden_s": [1, 3, 40], "50": [1, 3, 4, 6, 7, 8, 40, 44, 49], "output_s": [1, 3, 40], "10": [1, 3, 4, 6, 7, 8, 15, 40, 41, 42, 43, 44, 46, 47, 49, 50, 51, 52, 53], "fc1": [1, 3, 40], "fc2": [1, 3, 40], "relu": [1, 3, 15, 18, 40, 44, 47, 51], "masker": [1, 3, 40], "softmax": [1, 3, 40, 51], "dim": [1, 3, 4, 5, 6, 7, 8, 9, 13, 28, 40, 41, 51, 54], "_0_fc1": 1, "getattr": [1, 4, 6, 7, 8], "0": [1, 3, 4, 5, 6, 7, 8, 9, 16, 17, 18, 20, 21, 22, 33, 34, 40, 41, 44, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55], "_0_fc2": 1, "getitem_1": 1, "mul": 1, "bit": [1, 3, 44], "complic": [1, 18, 51], "visual": 1, "follow": [1, 3, 8, 18, 21, 31, 40, 43, 48, 50, 51, 55], "requir": [1, 3, 4, 6, 7, 8, 17, 21, 42, 43, 50, 51, 52], "pydot": 1, "visualis": 1, "graph_draw": 1, "fxgraphdraw": 1, "g": [1, 7, 8, 15, 16, 44, 47], "open": 1, "svg": 1, "wb": 1, "f": [1, 4, 6, 7, 8, 43, 44, 47, 48, 49, 51], "get_dot_graph": 1, "create_svg": 1, "which": [1, 3, 4, 5, 6, 7, 8, 9, 16, 21, 23, 33, 40, 42, 49, 50, 51, 52, 53, 54, 55], "dictionari": [2, 3, 4, 6, 7, 8, 13, 16, 17, 28, 42, 49], "like": [2, 3, 4, 6, 7, 8, 41, 42, 44, 47, 48, 49, 50, 54], "inherit": [2, 41, 42], "properti": [2, 4, 6, 7, 8, 51], "tensor": [2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 15, 16, 17, 18, 20, 21, 22, 23, 25, 28, 31, 33, 34, 36, 37, 39, 40, 41, 43, 44, 47, 48, 49, 51, 52, 53, 54, 55], "index": [2, 3, 4, 5, 6, 7, 8, 20, 41, 42, 45, 46, 50], "cast": [2, 4, 5, 6, 7, 8], "etc": [2, 8, 43, 44, 47], "base": [2, 3, 18, 40, 41, 44, 47, 48], "readabl": 2, "modular": [2, 21], "abstract": 2, "awai": 2, "tailor": 2, "i": [2, 3, 4, 6, 7, 8, 16, 44, 47, 48, 51, 53], "enumer": [2, 3, 44, 47, 48], "model": [2, 3, 29, 40, 43, 48, 52], "loss": [2, 3, 44, 47], "loss_modul": [2, 3], "backward": [2, 3, 44, 47], "optim": [2, 3, 43], "zero_grad": [2, 3, 44, 47], "With": [2, 3], "level": [2, 3, 40, 49], "recycl": 2, "train": [2, 3, 4, 6, 7, 8, 43, 44, 47, 48], "loop": [2, 3, 4, 6, 7, 8, 43, 44, 47, 48, 53], "heterogen": [2, 4], "task": [2, 3], "individu": [2, 44, 47], "collect": [2, 3, 4, 6, 7, 8, 27, 50], "transform": [2, 4, 6, 7, 8, 17, 22, 40, 44, 47], "predict": [2, 40, 47], "comput": [2, 3, 4, 16, 19, 21, 22, 32, 40, 48, 54], "hand": 2, "impact": [2, 4, 6, 7, 8, 49], "other": [2, 3, 4, 6, 7, 8, 18, 20, 23, 43, 48, 51, 54], "abov": [2, 42, 43, 48, 50, 53], "across": [2, 3, 4, 6, 7, 8, 23, 42], "classif": 2, "segment": 2, "among": [2, 9], "mani": [2, 3, 4, 6, 7, 8, 41, 54, 55], "manipul": [2, 3, 45, 46, 55], "kei": [2, 3, 4, 6, 7, 8, 9, 13, 16, 17, 18, 20, 21, 23, 28, 31, 40, 43, 44, 45, 46, 51, 52, 53, 54], "pre": [2, 41, 43, 44, 45, 46, 47, 48], "alloc": [2, 41, 43, 45, 46], "memori": [2, 4, 5, 6, 7, 8, 39, 44, 45, 46, 47, 48], "simplifi": [2, 42, 45, 46], "manag": [2, 31, 44, 45, 46, 47, 51], "tensordictmodul": [2, 15, 16, 18, 19, 21, 23, 35, 39, 40, 45, 46], "tensorclass": [2, 12, 39, 45, 46], "motiv": 2, "featur": [2, 8, 16, 17, 18, 40, 42, 43, 51], "dimens": [2, 4, 5, 6, 7, 8, 9, 23, 33, 53, 55], "nest": [2, 4, 6, 7, 8, 9, 13, 21, 23, 27, 28, 29, 41, 43, 54], "lazi": [2, 4, 5, 9, 21, 43, 54], "evalu": 2, "program": [2, 40], "distribut": [2, 3, 4, 6, 7, 8, 16, 21, 40, 42, 48, 51], "set": [2, 3, 4, 6, 7, 8, 17, 18, 20, 21, 24, 30, 31, 41, 42, 43, 48, 50], "map": [2, 4, 5, 6, 7, 8, 16, 17, 21, 39, 44, 47, 48, 51, 52], "node": [2, 3, 4, 6, 7, 8, 31, 40], "trace": [2, 39], "tensordictsequenti": [2, 3, 15, 18, 39, 40], "save": [2, 3, 4, 6, 7, 8, 41, 44, 47, 48, 50], "memmori": 2, "api": [2, 3, 40], "packag": [2, 3, 39], "subtensordict": [2, 4, 6, 8, 39], "lazystackedtensordict": [2, 9, 39, 43, 54], "persistenttensordict": [2, 4, 7, 8, 39], "util": [2, 34, 36, 37, 39, 44, 47, 48, 50, 52], "tensordictmodulebas": [2, 31, 39], "probabilistictensordictmodul": [2, 21, 39, 40], "tensordictmodulewrapp": [2, 39], "ensembl": [2, 3, 15, 39], "compil": [2, 39], "edg": [2, 39], "search": 2, "page": [2, 3], "easi": [3, 6, 17, 42, 48], "organis": 3, "reusabl": [3, 51], "develop": 3, "ve": [3, 51], "spun": 3, "separ": [3, 23, 49, 52], "librari": 3, "primarili": 3, "multipl": [3, 4, 6, 7, 8, 40, 41, 42, 48, 53, 54, 55], "mostli": 3, "relat": [3, 47, 48], "design": 3, "serialis": [3, 4, 6, 7, 8], "transmit": 3, "ship": 3, "own": 3, "functorch": [3, 40, 51, 52], "aim": [3, 5], "paramet": [3, 4, 5, 6, 7, 8, 9, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 27, 28, 29, 30, 31, 33, 34, 36, 37, 40, 49, 51, 52], "easier": [3, 43], "On": 3, "give": [3, 4, 6, 7, 8, 48], "what": [3, 18, 23, 40, 43, 51, 53], "re": [3, 4, 6, 7, 8, 16, 32, 40, 43, 51], "usabl": 3, "paradigm": 3, "most": [3, 40], "sl": 3, "ssl": 3, "ul": 3, "rl": 3, "tool": [3, 43], "littl": [3, 4, 6, 8, 48], "effort": [3, 44], "multiprocess": [3, 4, 6, 7, 8, 42], "seamlessli": [3, 4], "dispatch": [3, 17, 18], "datapoint": 3, "split": [3, 4, 5, 6, 7, 8, 41], "arang": [3, 4, 6, 7, 8, 48, 54], "rang": [3, 4, 44, 47, 51, 53], "pipe": 3, "tree_map": 3, "too": [3, 4, 6, 7, 8, 13, 18, 28, 43], "greater": 3, "degre": 3, "complex": [3, 40, 48, 51], "td": [3, 4, 6, 7, 8, 9, 13, 16, 17, 18, 21, 28, 33, 40, 43, 51], "11": [3, 4, 6, 7, 8, 40], "b": [3, 4, 6, 7, 8, 9, 13, 15, 18, 21, 23, 28, 33, 40, 43, 49, 50, 51, 53, 54, 55], "regular_dict": 3, "td0": [3, 4, 9], "td1": [3, 4, 6, 7, 8, 9], "td2": [3, 8, 43, 55], "unbind": [3, 4, 5, 6, 7, 8], "similar": [3, 4, 6, 7, 8, 16, 42, 43, 44, 47, 51, 54], "structur": [3, 4, 6, 7, 8, 9, 40, 43, 47, 48, 49, 50, 54, 55], "pytre": 3, "lambda": [3, 4, 6, 7, 8, 17, 18, 21, 44, 47, 48, 52], "regular_dict1": 3, "regular_dict2": 3, "regular_dict3": 3, "compel": 3, "c": [3, 4, 6, 7, 8, 13, 18, 21, 23, 28, 43, 49, 50], "decompos": [3, 23], "three": 3, "similarli": [3, 21, 43, 49, 51], "after": [3, 4, 5, 6, 7, 8, 20, 43, 48, 51, 53, 54], "appli": [3, 4, 6, 7, 8, 16, 48, 52, 54, 55], "quickli": 3, "becom": 3, "significantli": 3, "cumbersom": 3, "work": [3, 4, 6, 7, 8, 9, 13, 18, 20, 23, 28, 40, 42, 48, 49, 51, 54, 55], "naiv": 3, "want": [3, 18, 21, 23, 31, 47, 49, 50, 53, 54, 55], "rather": [3, 6, 43, 44, 47, 48], "unbound": [3, 4, 6, 7, 8], "dict": [3, 4, 6, 7, 8, 13, 16, 17, 28, 43, 49], "To": [3, 4, 6, 7, 8, 15, 31, 33, 41, 43, 49, 50, 51], "instanti": [3, 4, 49, 50], "must": [3, 4, 6, 7, 8, 16, 17, 23, 27, 33, 43, 48, 49, 50, 51, 54, 55], "specifi": [3, 4, 5, 6, 7, 8, 13, 16, 17, 28, 43, 47, 48, 49, 50, 51, 53, 54, 55], "valu": [3, 4, 5, 6, 7, 8, 16, 17, 18, 20, 21, 22, 25, 31, 33, 34, 41, 50, 51, 53], "pair": [3, 4, 6, 7, 8, 16], "well": [3, 44, 47, 48, 51], "lead": [3, 8, 13, 23, 28, 54, 55], "ani": [3, 4, 5, 6, 7, 8, 11, 12, 17, 18, 19, 20, 21, 41, 42, 43, 48, 49, 54], "zero": [3, 4, 6, 7, 8, 9, 17, 18, 21, 22, 23, 31, 34, 36, 37, 43, 48, 49, 51, 53, 55], "retriev": [3, 4, 5, 6, 7, 8, 9, 16, 44, 47, 49], "along": [3, 4, 5, 6, 7, 8, 16, 33, 40, 54, 55], "possibl": [3, 4, 5, 6, 7, 8, 13, 28, 40, 41, 42, 43, 49, 51], "obtain": [3, 43, 48, 49, 55], "congruent": 3, "just": [3, 21, 40, 42, 43, 44, 47, 48, 51, 54], "few": [3, 43, 48], "charact": 3, "nth": 3, "ellipsi": [3, 4, 6, 7, 8, 55], "sub_tensordict": 3, "inplac": [3, 4, 6, 7, 8, 49], "true": [3, 4, 5, 6, 7, 8, 11, 12, 15, 16, 18, 20, 21, 23, 27, 31, 34, 40, 43, 44, 47, 48, 49, 50, 51], "set_": [3, 4, 6, 7, 8, 49], "content": [3, 4, 5, 6, 7, 8, 20, 41, 42, 43, 47, 48, 50, 54], "fault": 3, "toler": [3, 8], "version": [3, 4, 6, 7, 8, 24], "latter": [3, 16, 17, 19], "match": [3, 4, 6, 7, 8, 13, 15, 16, 17, 23, 28, 36, 37, 40, 41, 51], "found": [3, 4, 6, 7, 8, 16, 18, 21, 48, 49, 51], "new": [3, 4, 5, 6, 7, 8, 18, 21, 33, 49, 50, 51, 55], "now": [3, 9, 40, 43, 48, 49, 51, 52], "place": [3, 4, 5, 6, 7, 8, 18, 24, 27, 40, 43, 50, 51, 53], "onto": [3, 4, 5, 6, 7, 8, 9, 43, 50], "particular": [3, 49, 54], "cuda": [3, 4, 5, 6, 7, 8, 44, 47, 48, 50], "reshap": [3, 4, 6, 7, 8, 41, 51], "includ": [3, 4, 6, 7, 8, 49], "squeez": [3, 4, 6, 7, 8, 41, 44, 47, 48], "unsqueez": [3, 4, 6, 7, 8, 48], "view": [3, 4, 6, 7, 8, 48, 55], "permut": [3, 4, 6, 7, 8], "stack": [3, 4, 6, 7, 8, 9, 15, 21, 34, 41, 48, 52], "cat": [3, 8, 41, 54], "present": [3, 4, 6, 7, 8, 17, 20, 21, 29, 31], "usual": 3, "solut": 3, "wa": [3, 4, 5, 6, 7, 8, 18], "given": [3, 4, 5, 6, 7, 8, 9, 16, 17, 21, 49, 51, 55], "construct": [3, 4, 16, 20, 40, 42, 51], "refin": [3, 4, 6, 7, 8], "later": [3, 16, 41, 43, 44, 48], "semant": 3, "refine_nam": [3, 4, 6, 7, 8], "z": [3, 17, 18], "y": [3, 4, 6, 7, 8, 17, 18, 41, 43, 44, 47], "renam": [3, 4, 6, 7, 8], "m": [3, 16, 20], "n": [3, 4, 6, 7, 8, 16, 44, 47, 49, 53, 54], "h": [3, 48], "themselv": [3, 49], "below": [3, 31, 54], "convert": [3, 4, 6, 7, 8, 20, 24, 27, 40, 43, 48, 50, 54], "rand": [3, 40, 43, 49, 50, 53, 54], "28": [3, 4, 6, 7, 8, 44, 47], "randint": [3, 4, 6, 7, 8, 40, 41, 48, 54], "tupl": [3, 4, 5, 6, 7, 8, 17, 18, 23, 49, 54, 55], "string": [3, 4, 6, 7, 8, 18, 23, 27, 49], "get": [3, 4, 5, 6, 7, 8, 16, 18, 21, 33, 40, 41, 48, 51, 53, 54], "altern": [3, 4, 6, 7, 8, 9, 13, 28, 40, 50], "defer": 3, "until": [3, 4, 6, 7, 8, 48], "item": [3, 4, 6, 7, 8, 41, 43, 44, 47, 49, 54], "immedi": [3, 5], "perform": [3, 4, 16, 19, 31, 41, 44, 48, 49, 54], "lazili": [3, 54], "lot": 3, "unnecessari": 3, "calcul": 3, "should": [3, 4, 5, 6, 7, 8, 15, 16, 17, 18, 19, 23, 32, 42, 43, 48, 49, 50], "_": [3, 4, 6, 7, 8, 16, 17, 20, 21, 23, 31, 51], "happen": [3, 54], "stacked_a": 3, "zeros_lik": [3, 52], "caveat": 3, "expens": [3, 4, 6, 7, 8, 48], "repeat": [3, 15, 44, 48, 54], "mai": [3, 4, 6, 7, 8, 18, 41, 43, 54], "caus": 3, "overhead": [3, 47, 48, 51], "avoid": [3, 4, 6, 7, 8, 17, 41, 48, 51], "contigu": [3, 4, 5, 6, 7, 8, 34, 42, 44, 47, 48, 50, 54, 55], "further": 3, "mitig": 3, "come": [3, 40, 48], "meta": [3, 41, 42, 43, 50], "metatensor": 3, "keep": [3, 4, 5, 6, 7, 8, 27, 43], "track": 3, "type": [3, 4, 6, 7, 8, 9, 11, 12, 13, 16, 28, 30, 34, 41, 43, 44, 47, 48], "entri": [3, 4, 6, 7, 8, 9, 18, 21, 31, 32, 34, 41, 43, 49, 50, 51, 54, 55], "suppos": [3, 51, 53], "foo": 3, "someth": 3, "automat": [3, 6, 9, 23], "subsequ": [3, 8, 21, 53], "iter": [3, 4, 6, 7, 8, 13, 17, 20, 21, 24, 27, 28, 44, 48, 53], "integr": 3, "wrap": [3, 15, 17, 19, 20, 23, 40], "accept": [3, 49, 51, 52, 54], "underli": [3, 5], "reason": 3, "high": [3, 40], "section": 3, "facilit": 3, "adopt": 3, "ident": [3, 4, 6, 7, 8, 41, 44, 47, 51], "previou": [3, 15, 43, 51], "box": 3, "pain": [3, 40], "inabl": [3, 40], "solv": [3, 40], "sequenc": [3, 4, 5, 6, 7, 8, 9, 13, 18, 21, 23, 28, 33, 34, 37, 40, 51], "know": [3, 40, 43], "mean": [3, 4, 6, 7, 8, 16, 17, 21, 40, 43, 48, 54, 55], "ignor": [3, 16, 19, 31, 40, 51], "predecessor": [3, 40], "necessari": [3, 6, 21, 23, 40, 43], "intermediate_x": 3, "second": [3, 15, 42, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "combin": [3, 23, 43, 48], "under": [3, 43, 48, 49, 53], "bunch": [3, 42], "list": [3, 4, 5, 6, 7, 8, 9, 16, 18, 21, 23, 31, 34, 40, 41, 51, 54], "ask": 3, "sub": [3, 4, 21, 23, 40, 43, 55], "select_subsequ": [3, 21, 40], "desir": [3, 4, 5, 6, 7, 8, 16, 30, 37, 50], "onli": [3, 4, 6, 7, 8, 9, 16, 17, 18, 21, 23, 31, 33, 48, 49, 51, 54], "indispens": 3, "satisfi": 3, "those": [3, 4, 6, 7, 8, 9, 16, 21, 50, 54, 55], "vmap": [3, 16, 17, 21, 40, 51, 52], "capabl": [3, 40, 43], "conjunct": [3, 49, 52, 54], "concaten": [3, 21, 41], "weight": [3, 4, 6, 7, 8, 18, 20, 49], "make_funct": [3, 16, 17, 21, 26, 40, 52], "layer1": [3, 40], "layer2": [3, 40], "hierarch": 3, "weights1": 3, "state_dict": [3, 40, 43], "unflatten_kei": [3, 40, 49], "weights2": 3, "param": [3, 4, 6, 7, 8, 16, 17, 18, 20, 21, 27, 40, 49, 52], "let": [3, 31, 51, 52, 53], "last": [3, 16, 40], "params_stack": 3, "d": [3, 4, 6, 7, 8, 16, 18, 21, 23, 44, 47], "compar": [3, 48], "functionalmodul": 3, "implement": [3, 4, 6, 40, 41, 44, 47, 48], "togeth": [4, 5, 14, 15, 23, 34, 40, 48, 51], "default": [4, 5, 6, 7, 8, 16, 17, 20, 21, 22, 23, 27, 31, 33, 34, 49, 50, 53, 54], "behaviour": [4, 18, 31, 41, 43], "them": [4, 6, 7, 8, 9, 16, 19, 34, 41, 42, 48, 51, 54], "affect": [4, 5, 21], "stack_dim": [4, 9, 54], "int": [4, 5, 6, 7, 8, 9, 13, 15, 16, 28, 33, 37, 48], "ndimens": 4, "hook_out": 4, "callabl": [4, 6, 7, 8, 15, 17], "hook_in": 4, "befor": [4, 6, 7, 8, 48, 49, 51, 52, 54], "td_stack": [4, 9], "tensordictbas": [4, 6, 7, 8, 9, 12, 14, 16, 17, 18, 19, 20, 21, 23, 33, 34, 36], "non": [4, 6, 7, 8, 16, 20, 21, 41, 48, 51, 54, 55], "null": [4, 6, 7, 8], "boolean": [4, 6, 7, 8, 41], "whether": [4, 5, 6, 7, 8, 15, 32], "integ": [4, 5, 6, 7, 8], "upon": [4, 5, 6, 7, 8], "append": 4, "analog": 4, "noth": 4, "fn": [4, 6, 7, 8], "str": [4, 5, 6, 7, 8, 13, 16, 17, 23, 24, 27, 28, 31, 41], "constructor_kwarg": [4, 6, 7, 8], "regardless": [4, 6, 7, 8], "argument": [4, 6, 7, 8, 13, 16, 17, 18, 20, 23, 28, 40, 43, 49, 50, 51, 54], "receiv": [4, 6, 7, 8], "number": [4, 6, 7, 8, 15, 16, 17, 23, 33, 34, 44, 47, 48, 49, 54], "being": [4, 5, 6, 7, 8, 23, 30, 31, 41, 50, 54], "keyword": [4, 6, 7, 8, 13, 16, 17, 20, 23, 28, 40, 43, 49, 50, 51], "modifi": [4, 5, 6, 7, 8, 18, 40, 43, 44, 47, 51, 52], "made": [4, 6, 7, 8, 27], "constructor": [4, 6, 7, 8, 23, 51], "transformed_in": [4, 6, 7, 8], "td_1": [4, 6, 7, 8], "td_2": [4, 6, 7, 8], "apply_": [4, 6, 7, 8], "copi": [4, 5, 6, 7, 8, 15, 40, 43, 50], "as_tensor": [4, 5, 6, 7, 8, 42, 48], "reserv": [4, 6, 7, 8], "exclus": [4, 6, 7, 8, 9, 31], "except": [4, 6, 7, 8, 19, 23, 53], "batch_dim": [4, 6, 7, 8, 54, 55], "length": [4, 6, 7, 8, 17, 55], "describ": [4, 6, 7, 8], "correspond": [4, 6, 7, 8, 16, 17, 27, 34, 43, 49, 54, 55], "arbitrari": [4, 6, 7, 8], "control": [4, 5, 6, 7, 8, 17, 43, 50], "initi": [4, 6, 7, 8, 15, 41], "e": [4, 6, 7, 8, 15, 16, 21, 44, 47], "infer": [4, 6, 7, 8, 51], "dynam": [4, 6, 7, 8], "bfloat16": [4, 6, 7, 8], "chunk": [4, 6, 7, 8, 43, 54], "tendordict": [4, 6, 7, 8], "clear": [4, 5, 6, 7, 8], "remov": [4, 6, 7, 8, 50, 54], "clear_device_": [4, 6, 7, 8], "recurs": [4, 6, 7, 8, 18, 49], "subclass": [4, 6, 7, 8, 11, 12, 16, 17, 18, 19, 21], "subtyp": [4, 6, 8], "to_tensordict": [4, 6, 7, 8, 9, 54], "sens": [4, 6, 8], "parent": [4, 6, 8, 20], "fall": [4, 6, 8], "back": [4, 6, 7, 8, 55], "copy_": [4, 6, 7, 8], "update_": [4, 6, 7, 8], "copy_at_": [4, 6, 7, 8], "union": [4, 6, 7, 8, 43], "update_at_": [4, 6, 7, 8], "create_nest": [4, 6, 7, 8], "overwritten": [4, 6, 7, 8, 19, 31, 49], "block": [4, 6, 7, 8, 40, 51], "lock": [4, 6, 7, 8, 48], "root": [4, 6, 7, 8, 44, 47, 48, 50, 54], "del_": [4, 6, 7, 8, 49], "delet": [4, 6, 7, 8, 49], "nestedkei": [4, 6, 7, 8, 16, 17, 21], "detach": [4, 6, 7, 8], "gradient": [4, 6, 7, 8, 44, 47], "detach_": [4, 6, 7, 8], "live": [4, 6, 7, 43], "doe": [4, 6, 7, 8, 21, 31, 40, 41, 42, 43, 49], "doubl": [4, 6, 7, 8], "rerproduc": [4, 6, 7, 8], "otherwis": [4, 5, 6, 7, 8, 12, 18, 23], "duplic": [4, 6, 7, 8, 15, 40], "entry_class": [4, 6, 7, 8], "isinst": [4, 6, 7, 8, 20, 43, 49, 54], "expand": [4, 6, 7, 8, 9, 15, 16, 17, 21, 36, 37, 48, 52], "accord": [4, 6, 7, 8], "practic": [4, 6, 7], "amend": [4, 6, 7], "sourc": [4, 6, 7, 8, 13, 23, 28, 44, 45, 47, 48, 49, 50, 51, 52, 53, 54, 55], "td_expand": [4, 6, 7], "fill_": [4, 6, 7, 8, 55], "float": [4, 6, 7, 8, 22, 25, 33, 34, 44, 47], "reman": [4, 6, 7, 8], "flatten": [4, 6, 7, 8, 40, 44, 47], "start_dim": [4, 6, 7, 8, 44, 47], "end_dim": [4, 6, 7, 8, 44, 47], "60": [4, 6, 7, 8, 44, 47], "12": [4, 6, 7, 8, 54], "td_flat": [4, 6, 7, 8], "8": [4, 6, 7, 8, 16, 17, 21, 40, 44, 47, 48, 51], "9": [4, 6, 7, 8, 44, 47], "13": [4, 6, 7, 8, 46, 47, 51], "14": [4, 6, 7, 8, 47], "15": [4, 6, 7, 8, 47], "16": [4, 6, 7, 8, 47], "17": [4, 6, 7, 8], "18": [4, 6, 7, 8], "19": [4, 6, 7, 8], "20": [4, 6, 7, 8, 44, 47], "21": [4, 6, 7, 8], "22": [4, 6, 7, 8], "23": [4, 6, 7, 8], "24": [4, 6, 7, 8, 17], "25": [4, 6, 7, 8], "26": [4, 6, 7, 8, 47, 48], "27": [4, 6, 7, 8, 46], "29": [4, 6, 7, 8, 47], "30": [4, 6, 7, 8], "31": [4, 6, 7, 8], "33": [4, 6, 7, 8, 47], "34": [4, 6, 7, 8], "35": [4, 6, 7, 8], "36": [4, 6, 7, 8], "37": [4, 6, 7, 8], "38": [4, 6, 7, 8, 47], "39": [4, 6, 7, 8, 47], "40": [4, 6, 7, 8], "41": [4, 6, 7, 8], "42": [4, 6, 7, 8, 48], "43": [4, 6, 7, 8, 47], "44": [4, 6, 7, 8], "45": [4, 6, 7, 8], "46": [4, 6, 7, 8], "47": [4, 6, 7, 8], "48": [4, 6, 7, 8, 44, 47], "49": [4, 6, 7, 8], "51": [4, 6, 7, 8], "52": [4, 6, 7, 8, 48], "53": [4, 6, 7, 8], "54": [4, 6, 7, 8, 47], "55": [4, 6, 7, 8, 47], "56": [4, 6, 7, 8], "57": [4, 6, 7, 8, 44], "58": [4, 6, 7, 8, 47], "59": [4, 6, 7, 8, 44, 46, 47], "static": [4, 6, 7, 8], "from_modul": [4, 6, 7, 8, 18, 20], "transformerdecod": [4, 6, 7, 8, 51], "decoder_lay": [4, 6, 7, 8], "transformerdecoderlay": [4, 6, 7, 8], "nhead": [4, 6, 7, 8], "d_model": [4, 6, 7, 8], "num_lay": [4, 6, 7, 8], "layer": [4, 6, 7, 8, 48, 51, 52], "linear1": [4, 6, 7, 8], "bia": [4, 6, 7, 8, 20, 22, 25, 44, 47, 49], "2048": [4, 6, 7, 8], "gather": [4, 6, 7, 8, 48, 51], "axi": [4, 6, 7, 8], "element": [4, 6, 7, 8, 9, 16, 17, 23, 54], "long": [4, 6, 7, 8, 13, 28, 48, 55], "Its": [4, 6, 7, 8, 17], "destin": [4, 6, 7, 8, 34, 43], "td_gather": [4, 6, 7, 8], "gather_and_stack": [4, 6, 7, 8], "dst": [4, 6, 7, 8], "variou": [4, 6, 7, 8], "rank": [4, 6, 7, 8], "mp": [4, 6, 7, 8], "client": [4, 6, 7, 8], "init_process_group": [4, 6, 7, 8], "gloo": [4, 6, 7, 8], "world_siz": [4, 6, 7, 8], "init_method": [4, 6, 7, 8], "tcp": [4, 6, 7, 8], "localhost": [4, 6, 7, 8], "10003": [4, 6, 7, 8], "sent": [4, 5, 6, 7, 8, 42, 50], "server": [4, 6, 7, 8], "equal": [4, 6, 7, 8, 33, 41], "yuppi": [4, 6, 7, 8], "__name__": [4, 6, 7, 8], "__main__": [4, 6, 7, 8], "set_start_method": [4, 6, 7, 8], "spawn": [4, 6, 7, 8], "main_work": [4, 6, 7, 8], "secondary_work": [4, 6, 7, 8], "start": [4, 6, 7, 8, 33, 48], "join": [4, 6, 7, 8], "compatibletyp": [4, 6, 7, 8, 13, 28], "_no_default_": [4, 6, 7, 8], "equival": [4, 5, 6, 7, 8, 23, 49], "chain": [4, 6, 7, 8, 15, 21], "get_at": [4, 6, 7, 8], "get_item_shap": [4, 6, 7, 8], "ineffici": [4, 54], "attempt": 4, "get_nestedtensor": 4, "cannot": [4, 23, 48], "optiona": 4, "isn": 4, "t": [4, 8, 31, 43, 44, 47, 48, 54, 55], "nestedtensor": 4, "build": [4, 16, 40, 41, 51], "anyth": [4, 31], "els": [4, 6, 7, 8, 31, 44, 47, 48, 49], "b2": 4, "get_sub_tensordict": [4, 6, 7, 8, 55], "half": [4, 6, 7, 8], "insert": [4, 6, 7, 8], "irecv": [4, 6, 7, 8], "src": [4, 6, 7, 8], "return_prematur": [4, 6, 7, 8], "init_tag": [4, 6, 7, 8], "pseudo_rand": [4, 6, 7, 8], "futur": [4, 6, 7, 8], "asynchron": [4, 6, 7, 8], "isend": [4, 6, 7, 8], "context": [4, 6, 7, 8, 31, 48, 51], "wait": [4, 6, 7, 8, 48], "complet": [4, 6, 7, 8], "withing": [4, 6, 7, 8], "tag": [4, 6, 7, 8], "pseudo": [4, 6, 7, 8], "random": [4, 6, 7, 8, 16, 48, 53], "overlap": [4, 6, 7, 8], "1e": [4, 6, 7, 8, 44, 47], "sec": [4, 6, 7, 8], "slow": [4, 6, 7, 8], "down": [4, 6, 7, 8], "runtim": [4, 6, 7, 8], "your": [4, 6, 7, 8, 41, 43, 48], "algorithm": [4, 6, 7, 8], "is_contigu": [4, 6, 7, 8], "share_memory_": [4, 6, 7, 8], "consid": [4, 6, 7, 8, 21, 41, 48, 54], "alwai": [4, 6, 7, 8, 17, 18, 21, 54], "mark": [4, 6, 7, 8], "note": [4, 6, 7, 8, 9, 16, 41, 44, 47, 48, 51, 54], "increment": [4, 6, 7, 8], "queue": [4, 6, 7, 8], "fut": [4, 6, 7, 8], "timeout": [4, 6, 7, 8], "include_nest": [4, 6, 7, 8, 49], "leaves_onli": [4, 6, 7, 8, 49], "_lazystackedtensordictkeysview": 4, "masked_fil": [4, 6, 7, 8, 48], "masked_fill_": [4, 6, 7, 8], "masked_select": [4, 6, 7, 8], "td_mask": [4, 6, 7, 8], "copy_exist": [4, 6, 7, 8, 43], "correct": [4, 6, 7, 8, 43, 44, 47], "onc": [4, 5, 6, 7, 8, 19, 48, 54], "unlock": [4, 6, 7, 8], "turn": [4, 6, 7, 8, 15, 20, 40], "becaus": [4, 6, 7, 8, 43, 44, 47, 48, 53], "cross": [4, 6, 7, 8, 44, 47], "guarante": [4, 6, 7, 8, 54, 55], "anymor": [4, 6, 7, 8], "fashion": [4, 6, 7, 8, 47, 54], "might": [4, 6, 7, 8], "deepli": [4, 6, 7, 8], "recommend": [4, 6, 7, 8, 43], "insid": [4, 6, 7, 8, 43, 44, 47, 48], "memmap_lik": [4, 6, 7, 8, 50], "numel": [4, 6, 7, 8, 48], "total": [4, 6, 7, 8, 44, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55], "dims_list": [4, 6, 7, 8], "order": [4, 6, 7, 8, 17, 21, 23, 34, 40, 51, 52], "permutedtensordict": [4, 6, 7, 8], "op": [4, 5, 6, 7, 8, 54], "pin_memori": [4, 6, 7, 8, 48], "pop": [4, 6, 7, 8], "k": [4, 6, 7, 8, 51], "v": [4, 6, 7, 8, 51], "keyerror": [4, 6, 7, 8], "popitem": [4, 6, 7, 8], "recv": [4, 6, 7, 8], "reduc": [4, 6, 7, 8], "redoptyp": [4, 6, 7, 8], "sum": [4, 6, 7, 8, 44, 47], "async_op": [4, 6, 7, 8], "machin": [4, 6, 7, 8, 42], "go": [4, 6, 7, 8, 43, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "special": [4, 6, 7, 8, 51], "lift": [4, 6, 7, 8], "unnam": [4, 6, 7, 8, 23], "coexist": [4, 6, 7, 8], "nice": [4, 6, 7, 8], "awar": [4, 6, 7, 8], "both": [4, 6, 7, 8, 42, 48, 51, 53, 54], "up": [4, 6, 7, 8, 31, 44, 49, 51], "greedili": [4, 6, 7, 8], "accordingli": [4, 6, 7, 8, 31], "rename_key_": [4, 6, 7, 8, 49], "old_kei": [4, 6, 7, 8], "new_kei": [4, 6, 7, 8], "safe": [4, 6, 7, 8], "error": [4, 6, 7, 8, 43, 44, 47], "thrown": [4, 6, 7, 8, 41], "select": [4, 6, 7, 8, 18, 21, 40, 55], "strict": [4, 6, 7, 8, 41], "modif": [4, 6, 7, 8], "either": [4, 6, 7, 8, 9, 23, 41, 49, 50, 54], "prune": [4, 6, 7, 8], "distant": [4, 6, 7, 8], "occur": [4, 6, 7, 8, 18, 20], "while": [4, 6, 7, 8, 16, 19, 41, 43, 48, 50], "set_at_": [4, 6, 7, 8], "setdefault": [4, 6, 7, 8, 49], "Will": [4, 6, 7, 8], "previous": [4, 6, 7, 8], "share_memori": [4, 6, 7, 8], "sorted_kei": [4, 6, 7, 8], "sort": [4, 6, 7, 8, 23], "alphabet": [4, 6, 7, 8], "extra": [4, 6, 7, 8, 23, 42], "cach": [4, 6, 7, 8], "split_siz": [4, 6, 7, 8], "remain": [4, 6, 7, 8, 41, 49, 53], "maintain": [4, 6, 7, 8], "compris": [4, 6, 7, 8], "singleton": [4, 6, 7, 8, 54], "dest": [4, 5, 6, 7, 8, 23, 36], "devicetyp": [4, 5, 6, 7, 8, 13, 28, 34], "permit": [4, 6, 7, 8], "bound": [4, 6, 7, 8], "to_dict": [4, 6, 7, 8], "to_h5": [4, 6, 7, 8], "filenam": [4, 5, 6, 7, 8], "h5": [4, 6, 7, 8], "backend": [4, 6, 7, 8], "path": [4, 5, 6, 7, 8, 43, 48, 50], "expect": [4, 6, 7, 8, 15, 18, 21, 23, 31], "h5py": [4, 6, 7, 8], "create_dataset": [4, 6, 7, 8], "persitenttensordict": [4, 6, 7, 8], "link": [4, 6, 7, 8], "newli": [4, 6, 7, 8], "tempfil": [4, 6, 7, 8], "timeit": [4, 6, 7, 8], "1_000_000": [4, 6, 7, 8, 42], "namedtemporaryfil": [4, 6, 7, 8], "td_h5": [4, 6, 7, 8], "compress": [4, 6, 7, 8], "gzip": [4, 6, 7, 8], "compression_opt": [4, 6, 7, 8], "1000000": [4, 6, 7, 8], "transpos": [4, 6, 7, 8, 51], "dim0": [4, 6, 7, 8], "dim1": [4, 6, 7, 8], "tensordit": [4, 6, 7, 8], "swap": [4, 6, 7, 8, 54], "tensordict_transpos": [4, 6, 7, 8], "dst_type": [4, 6, 7, 8], "unflatten": [4, 6, 7, 8], "unflattened_s": [4, 6, 7, 8], "td_unflat": [4, 6, 7, 8], "input_dict_or_td": [4, 6, 7, 8], "unlik": [4, 6, 7, 8, 40, 43, 49, 51], "throw": [4, 6, 7, 8], "unknown": [4, 6, 7, 8], "indextyp": [4, 6, 7, 8], "valid_kei": 4, "td_view": [4, 6, 7, 8], "zero_": [4, 6, 7, 8], "transfer_ownership": 5, "mode": [5, 6, 16, 30, 31], "r": [5, 6, 16], "np": 5, "scope": [5, 6], "transfer": [5, 48], "serial": [5, 42, 43], "deseri": 5, "choos": 5, "ownership": 5, "almost": 5, "tensor_or_s": 5, "te": 5, "get_default_dtyp": 5, "loos": 5, "deprec": [5, 16], "x_memmap": 5, "from_tensor": 5, "x0": 5, "temp": 5, "clearanc": 5, "os": [5, 48], "isfil": 5, "del": [5, 49], "ie": [5, 6, 8, 17, 18, 21, 43], "defin": [5, 16, 19, 47, 48, 51], "set_transfer_ownership": 5, "non_block": 5, "persist": [6, 43], "group": [6, 52], "close": 6, "w": [6, 21, 48], "newfil": 6, "materi": 6, "classmethod": [6, 8, 47, 48], "from_dict": [6, 8], "input_dict": [6, 7, 8, 13, 28], "determin": [6, 8, 13, 23, 28, 43, 53], "from_h5": 6, "_persistenttdkeysview": 6, "fail": [6, 23], "By": [7, 16, 17, 21, 49, 50, 54], "td_index": 7, "sub_data": 7, "int64": [7, 40, 41, 44, 47, 48], "data_ptr": 7, "140183705558208": 7, "sub_data_clon": 7, "_tensordictkeysview": [7, 8], "discard_idx_attr": 7, "least": 8, "th": 8, "addition": [8, 49], "limit": 8, "expend": 8, "right": [8, 36, 37], "td_unsqueez": 8, "a_view": 8, "td_cpu": 8, "td_savec": 8, "savedtensordict": 8, "td_or_dict": 8, "old_nam": 8, "new_nam": 8, "tensordict_list": 8, "immut": 8, "unless": [8, 15, 20, 31, 51], "won": [8, 31], "lsit": 8, "td_unqueez": 8, "hasn": 8, "maximum": [8, 13, 23, 28], "exclusinv": 8, "__maximum__": 8, "smaller": 8, "sie": [8, 13, 28], "input_td": [8, 13, 28, 40], "td_list": 9, "dens": 9, "obtrain": 9, "infeas": 9, "thu": 9, "assert_allclose_td": 9, "td_lazi": 9, "td_contain": 9, "td_container_clon": 9, "exclusive_field": [9, 54], "push": 9, "reveal": 9, "arg0": 10, "datatyp": [11, 12], "lib": 12, "istanc": 12, "myclass": [12, 41, 43], "incompat": [13, 28], "merg": 14, "form": [15, 33], "num_copi": [15, 40], "parameter_init_funct": 15, "expand_input": 15, "cnn": 15, "mlp": 15, "mod": [15, 18, 21, 40], "mind": [15, 54], "off": 15, "bork": [15, 18], "dork": [15, 18], "next_modul": 15, "spork": 15, "e0": 15, "e1": 15, "seq": [15, 18, 21], "probabilist": 16, "parametr": [16, 51], "sampl": [16, 18, 30, 40, 51], "rule": [16, 51], "default_interaction_typ": [16, 51], "interaction_typ": 16, "global": [16, 31, 51], "get_dist": [16, 51], "__call__": [16, 48, 51], "real": 16, "median": 16, "rsampl": 16, "skip": [16, 31, 51], "suppli": 16, "delta": 16, "wrapper": [16, 17, 19, 20], "around": [16, 17], "determinist": 16, "importantli": 16, "leaf": 16, "interest": 16, "loc": [16, 21, 40, 48, 51], "scale": [16, 21, 40, 48, 51], "normal": [16, 21, 40, 48, 51], "default_interaction_mod": 16, "pleas": [16, 54], "interactiontyp": [16, 30], "randomli": [16, 48], "drawn": 16, "probabilistictdmodul": [16, 30], "look": [16, 21, 52], "interact": 16, "dictat": 16, "datacollector": 16, "set_interaction_typ": 16, "distribution_class": [16, 21, 40, 51], "distribution_kwarg": 16, "return_log_prob": [16, 21, 40, 51], "log": [16, 51], "log_prob_kei": 16, "log_prob": 16, "sample_log_prob": [16, 21, 40, 51], "cache_dist": 16, "diverg": 16, "action": [16, 40, 50, 51], "ppo": 16, "n_empirical_estim": 16, "empir": 16, "avail": 16, "probabilistictensordictsequenti": [16, 21, 40, 51], "normalparamextractor": [16, 21, 51], "functional_modul": [16, 17, 21, 40], "hidden": [16, 17, 21, 40, 51], "grucel": [16, 17, 40, 51], "normal_param": [16, 21], "prob_modul": [16, 40], "td_modul": [16, 17, 19, 21, 35, 40, 51], "funs_to_decor": [16, 24, 27], "dist": [16, 51], "td_vmap": [16, 17, 21], "_requires_sampl": 16, "overridden": [16, 19], "recip": [16, 19], "within": [16, 19, 20, 23, 40], "afterward": [16, 19], "sinc": [16, 19, 23, 40, 43, 44, 47, 48, 54, 55], "care": [16, 19, 31], "regist": [16, 19, 20, 51], "hook": [16, 19, 40], "silent": [16, 19], "python": [17, 44, 45, 47, 48, 49, 50, 51, 52, 53, 54, 55], "signatur": [17, 18, 21, 31, 40], "typic": 17, "space": [17, 48], "nestedstr": 17, "embed": 17, "neural": [17, 51], "network": [17, 40, 51], "128": [17, 48], "tgt": 17, "td_function": 17, "state": [17, 24, 27, 43], "td_state": 17, "extract_weights_and_buff": 17, "params_repeat": 17, "bias_hh": 17, "bias_ih": 17, "weight_hh": 17, "weight_ih": 17, "character": 18, "convent": 18, "tensordict_in": 18, "reset_out_kei": 18, "reset": [18, 41], "orign": 18, "select_out_kei": 18, "reset_parameters_recurs": 18, "children": 18, "old_param": 18, "reset_paramet": 18, "whenev": [18, 31, 54], "rid": 18, "presenc": 18, "trigger": 18, "unexpect": 18, "out_keys_sourc": 18, "simplest": 18, "usag": [18, 52], "rubric": [18, 21, 31], "revert": 18, "behav": [19, 54], "exactli": [19, 20, 40, 54], "hold": [20, 44, 47, 48, 55], "full": [20, 41, 42, 43, 44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "expos": [20, 47, 48, 51, 54], "over": [20, 21, 41, 44, 47, 48, 52], "leav": [20, 23, 31], "flatten_kei": [20, 40, 49], "therefor": 20, "named_paramet": [20, 40, 49], "slightli": [20, 48, 51], "term": 20, "augment": 20, "convers": 20, "no_convert": 20, "lock_": 20, "p": [20, 52], "custommodul": 20, "assign": [20, 41, 51, 53], "tensordictsequenci": 21, "partial_toler": 21, "miss": [21, 43], "who": 21, "AND": 21, "scan": 21, "manual_se": 21, "7214": 21, "8748": 21, "1571": 21, "1138": 21, "grad_fn": 21, "addbackward0": 21, "tensordictsequ": 21, "net1": 21, "module1": 21, "td_module1": 21, "module2": 21, "td_module2": 21, "absent": 21, "relev": 21, "discard": 21, "pattern": 21, "assum": [21, 23, 48], "condit": 21, "acord": 21, "idn": 21, "whose": [21, 49, 53, 54, 55], "depend": [21, 31], "modulelist": [21, 51], "0x126ed1ca0": 21, "propag": 21, "submodul": 21, "0x129efae50": 21, "min_val": 22, "01": [22, 46, 47], "bias": 22, "softplu": [22, 25], "scalar": 22, "_bia": 22, "shift": 22, "minimum": 22, "auto_batch_s": 23, "mymodul": [23, 31], "keys_in": 23, "keys_out": 23, "dispatch_kwarg": 23, "mymodulenest": 23, "a_c": 23, "sep": 23, "asepc": 23, "__not__": 23, "inform": [23, 43], "word": [23, 43], "oopsi": 23, "invers": 25, "invert": 25, "keep_param": 27, "return_param": 27, "belong": 27, "decor": [27, 31, 41], "repopul": 29, "polici": 30, "in_key_attr": 31, "out_key_attr": 31, "skip_exist": 31, "abl": [31, 41, 43, 48, 54, 55], "respect": [31, 48, 54], "fun": [31, 51], "partial": 31, "intend": 31, "outsid": 31, "hello": 31, "ot": 31, "thing": [31, 49], "mistakenli": 31, "subgraph": 31, "deactiv": 31, "pad_siz": 33, "constant": 33, "move": [33, 48, 50], "len": [33, 44, 47, 48, 51, 54], "padding_left": 33, "padding_right": 33, "padding_top": 33, "padding_bottom": 33, "less": 33, "twice": 33, "dim0_left": 33, "dim0_right": 33, "dim1_left": 33, "dim1_right": 33, "padded_td": [33, 34], "list_of_tensordict": 34, "batch_first": 34, "padding_valu": 34, "return_mask": 34, "pad": 34, "format": 34, "rnn": 34, "provd": 34, "valid": [34, 41, 48, 50], "list_td": 34, "tdgraphmodul": 35, "symbol": 35, "tracer": 35, "flexibl": [40, 43, 48, 51], "ml": 40, "pipelin": [40, 44, 47, 48], "part": [40, 48, 51], "basic": [40, 48], "512": [40, 44, 47], "necessarili": 40, "custom": [40, 41, 47, 48], "suffic": 40, "sub_modul": 40, "summari": 40, "statist": 40, "normalparamwrapp": 40, "dedic": [40, 47, 48], "leverag": 40, "reflect": 40, "extract": [40, 47, 48, 51], "These": [40, 53, 54], "though": [40, 41, 48, 54], "out2": 40, "test": [40, 41, 44, 47, 51, 54], "assert_clos": 40, "distinguish": 40, "pack": [40, 42], "funciton": 40, "howev": [40, 41, 42, 43, 49, 50, 52, 55], "get_funct": 40, "break": [40, 43, 44, 47, 51], "reli": 40, "approach": [40, 48], "enabl": 40, "straightforward": 40, "reiniti": 40, "ensemblemodul": 40, "help": [41, 48], "restrict": 41, "predefin": 41, "strictli": 41, "enforc": 41, "__future__": [41, 43], "annot": [41, 43], "mydata": 41, "floatdata": 41, "intdata": 41, "non_tensordata": 41, "sparse_data": 41, "keyedjaggedtensor": 41, "check_nest": 41, "nested_test": 41, "intern": 41, "test_chang": 41, "repr": 41, "nested_test_chang": 41, "data2": 41, "cat_tc": 41, "catted_tc": 41, "inequ": 41, "sure": [41, 51], "discrep": 41, "non_tensor": 41, "userwarn": 41, "test_new": 41, "undefin": 41, "stack_tc": 41, "primit": 42, "handi": 42, "de": 42, "consist": [42, 43], "plu": 42, "reconstruct": [42, 43], "goe": 42, "my_imag": 42, "unint8": 42, "mini_batch": 42, "wherea": [42, 51], "ob": 42, "my_tensordict": 43, "imagin": 43, "situat": 43, "torchsnapshot": 43, "mimic": [43, 49, 50], "moreov": [43, 51], "natur": 43, "buit": 43, "huge": 43, "hundr": 43, "gb": 43, "ram": [43, 48], "There": 43, "don": [43, 54], "advanc": 43, "margin": [43, 51], "choic": [43, 47, 48], "rememb": 43, "tensordict_sourc": 43, "snapshot": 43, "app_stat": 43, "my": 43, "hood": 43, "tensordict_target": 43, "load_state_dict": 43, "state_target": 43, "restor": 43, "uuid": 43, "uuid4": 43, "tensordict2": 43, "target_st": 43, "small": 43, "prealloc": 43, "price": 43, "pai": 43, "checkpoint": 43, "dataload": 43, "contrast": 43, "again": [43, 49], "line": [43, 54], "suffici": 43, "statedict": 43, "explicitli": 43, "my_tensordict_sourc": 43, "implic": 43, "unnot": 43, "td_dest": 43, "saniti": 43, "fairli": 43, "tc": 43, "tc_dest": 43, "date": 43, "yield": 43, "pt": [43, 50], "walk": 43, "henc": [43, 48, 50], "load_memmap": 43, "subdirectori": [43, 48], "td3": 43, "left": [43, 54], "unmodifi": 43, "end": [44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "download": [44, 45, 47, 48, 49, 50, 51, 52, 53, 54, 55], "tutori": [44, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55], "transpar": [44, 47, 48], "heavili": [44, 47], "quickstart": [44, 47], "torchvis": [44, 47, 48], "totensor": [44, 47, 48], "is_avail": [44, 47, 48], "conveni": [44, 47, 48, 51], "prepar": [44, 47], "rel": [44, 47, 54], "fashionmnist": [44, 47], "cloth": [44, 47], "classifi": [44, 47], "bag": [44, 47], "sneaker": [44, 47], "training_data": [44, 47], "test_data": [44, 47], "repeatedli": [44, 47], "training_data_td": 44, "test_data_td": 44, "Then": 44, "front": 44, "dure": [44, 48, 49, 53], "img": 44, "__len__": [44, 47, 48], "__getitem__": [44, 47, 48], "__getitems__": [44, 47, 48], "style": [44, 47, 48], "collat": [44, 47, 48], "collate_fn": [44, 47, 48], "64": [44, 47, 48], "train_dataload": [44, 47, 48], "test_dataload": [44, 47], "train_dataloader_td": 44, "test_dataloader_td": 44, "linear_relu_stack": [44, 47], "model_td": 44, "in_featur": [44, 47], "784": [44, 47], "out_featur": [44, 47], "optimis": [44, 47], "stochast": [44, 47], "descent": [44, 47], "entropi": [44, 47], "loss_fn": [44, 47], "crossentropyloss": [44, 47], "sgd": [44, 47], "lr": [44, 47], "optimizer_td": 44, "pred": [44, 47], "7f": [44, 47], "5d": [44, 47], "veri": [44, 47], "adjust": [44, 47], "unpack": [44, 47], "explicit": [44, 47], "train_td": 44, "num_batch": [44, 47], "eval": [44, 47], "test_loss": [44, 47], "no_grad": [44, 47], "argmax": [44, 47], "accuraci": [44, 47], "1f": [44, 47], "avg": [44, 47], "8f": [44, 47], "test_td": 44, "epoch": [44, 47, 48], "4f": [44, 47, 48], "296734": 44, "60000": [44, 47], "293707": 44, "6400": [44, 47], "271066": 44, "12800": [44, 47], "268403": 44, "19200": [44, 47], "264432": 44, "25600": [44, 47], "228607": 44, "32000": [44, 47], "239032": 44, "38400": [44, 47], "202275": 44, "44800": [44, 47], "196422": 44, "51200": [44, 47], "179173": 44, "57600": [44, 47], "167921": 44, "175446": 44, "169526": 44, "109504": 44, "126982": 44, "086474": 44, "023569": 44, "052037": 44, "975272": 44, "977809": 44, "914546": 44, "909470": 44, "941952": 44, "915850": 44, "794494": 44, "834231": 44, "731235": 44, "677648": 44, "698794": 44, "601937": 44, "625349": 44, "520408": 44, "536073": 44, "604289": 44, "570560": 44, "415458": 44, "483225": 44, "368229": 44, "358710": 44, "372501": 44, "299377": 44, "333131": 44, "234650": 44, "63": 44, "258167": 44, "336011": 44, "318132": 44, "151371": 44, "252402": 44, "130629": 44, "150963": 44, "172514": 44, "113036": 44, "150375": 44, "069430": 44, "65": 44, "087252": 44, "1676": 44, "308781": 44, "296852": 44, "282470": 44, "273028": 44, "246969": 44, "224218": 44, "227514": 44, "190559": 44, "193277": 44, "163409": 44, "156891": 44, "163764": 44, "156995": 44, "101947": 44, "120872": 44, "063246": 44, "004781": 44, "034105": 44, "948219": 44, "955907": 44, "888417": 44, "881372": 44, "909538": 44, "881962": 44, "761459": 44, "812140": 44, "694522": 44, "638345": 44, "672318": 44, "559959": 44, "590212": 44, "488838": 44, "502525": 44, "565242": 44, "532742": 44, "380132": 44, "464673": 44, "338732": 44, "326011": 44, "350948": 44, "268912": 44, "305532": 44, "211114": 44, "235645": 44, "310426": 44, "293973": 44, "127789": 44, "241944": 44, "112391": 44, "130032": 44, "158642": 44, "093685": 44, "130487": 44, "053712": 44, "073251": 44, "76": 44, "2101": 44, "minut": [44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "185": [44, 46], "data_fashion": [44, 46], "py": [44, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55], "jupyt": [44, 45, 47, 48, 49, 50, 51, 52, 53, 54, 55], "notebook": [44, 45, 47, 48, 49, 50, 51, 52, 53, 54, 55], "ipynb": [44, 47, 48, 49, 50, 51, 52, 53, 54, 55], "galleri": [44, 45, 47, 48, 49, 50, 51, 52, 53, 54, 55], "sphinx": [44, 45, 47, 48, 49, 50, 51, 52, 53, 54, 55], "tutorials_python": 45, "zip": 45, "tutorials_jupyt": 45, "04": [46, 47], "114": 46, "tensorclass_fashion": [46, 47], "02": [46, 47, 48], "264": [46, 47], "mb": 46, "tensordict_modul": [46, 51], "00": [46, 47, 48], "256": [46, 48, 51], "tensorclass_imagenet": [46, 48], "252": [46, 48], "tensordict_memori": [46, 50], "055": [46, 50], "tensordict_module_funct": [46, 52], "027": [46, 52], "tensordict_sl": [46, 55], "023": [46, 55], "tensordict_shap": [46, 54], "020": [46, 54], "tensordict_kei": [46, 49], "018": [46, 49], "tensordict_prealloc": [46, 53], "016": [46, 53], "http": 47, "mnist": 47, "s3": 47, "websit": 47, "eu": 47, "central": 47, "amazonaw": 47, "com": 47, "idx3": 47, "ubyt": 47, "gz": 47, "raw": [47, 48], "26421880": 47, "32768": 47, "212806": 47, "83it": 47, "65536": 47, "05": 47, "209670": 47, "73it": 47, "131072": 47, "303911": 47, "07it": 47, "229376": 47, "430060": 47, "00it": 47, "491520": 47, "874922": 47, "35it": 47, "950272": 47, "1566455": 47, "38it": 47, "1933312": 47, "07": 47, "3091067": 47, "74it": 47, "3833856": 47, "03": 47, "5941937": 47, "94it": 47, "6881280": 47, "10116185": 47, "39it": 47, "9928704": 47, "12952506": 47, "12681216": 47, "14320391": 47, "23it": 47, "15695872": 47, "15772681": 47, "55it": [47, 48], "71": 47, "18743296": 47, "16843408": 47, "17it": 47, "81": 47, "21463040": 47, "16956457": 47, "93": 47, "24543232": 47, "17697216": 47, "26it": 47, "11043763": 47, "72it": 47, "idx1": 47, "29515": 47, "188538": 47, "98it": 47, "187971": 47, "29it": 47, "t10k": 47, "4422102": 47, "209274": 47, "53it": 47, "208746": 47, "15it": 47, "303729": 47, "80it": 47, "09": 47, "430442": 47, "425984": 47, "725877": 47, "79it": 47, "884736": 47, "1470657": 47, "45it": 47, "1736704": 47, "2760948": 47, "54it": [47, 48], "79": 47, "3473408": 47, "5398265": 47, "3503321": 47, "5148": 47, "29537998": 47, "62it": 47, "dataclass": [47, 48], "good": [47, 48], "fix": 47, "As": [47, 48, 53, 54, 55], "encapsul": [47, 48], "logic": [47, 48], "from_dataset": [47, 48], "fashionmnistdata": 47, "cl": [47, 48], "incur": 47, "training_data_tc": 47, "test_data_tc": 47, "train_dataloader_tc": [47, 48], "test_dataloader_tc": 47, "model_tc": 47, "optimizer_tc": 47, "train_tc": 47, "test_tc": 47, "295353": 47, "290151": 47, "269783": 47, "269748": 47, "245886": 47, "211795": 47, "232165": 47, "188162": 47, "200849": 47, "163448": 47, "159944": 47, "167221": 47, "163831": 47, "111053": 47, "130718": 47, "063779": 47, "012843": 47, "045893": 47, "964310": 47, "987028": 47, "903481": 47, "906295": 47, "938098": 47, "912920": 47, "806296": 47, "841343": 47, "706880": 47, "675523": 47, "692065": 47, "594486": 47, "624010": 47, "512897": 47, "533755": 47, "599872": 47, "566423": 47, "425027": 47, "489586": 47, "348060": 47, "366066": 47, "372380": 47, "296917": 47, "334595": 47, "238896": 47, "62": 47, "260448": 47, "339021": 47, "319766": 47, "159757": 47, "262753": 47, "122469": 47, "165259": 47, "181746": 47, "114832": 47, "157789": 47, "079994": 47, "094854": 47, "3335": 47, "311549": 47, "297157": 47, "280546": 47, "269716": 47, "257046": 47, "231999": 47, "231764": 47, "205740": 47, "206980": 47, "168048": 47, "166382": 47, "179831": 47, "169449": 47, "116161": 47, "127118": 47, "083751": 47, "025659": 47, "048009": 47, "975864": 47, "987761": 47, "909316": 47, "913334": 47, "947671": 47, "917446": 47, "812461": 47, "844512": 47, "739483": 47, "690704": 47, "708561": 47, "613528": 47, "644753": 47, "531061": 47, "553564": 47, "621006": 47, "583894": 47, "446816": 47, "503496": 47, "383349": 47, "380231": 47, "390584": 47, "317981": 47, "356228": 47, "251950": 47, "277904": 47, "357577": 47, "334956": 47, "182518": 47, "273563": 47, "144352": 47, "172794": 47, "193115": 47, "131988": 47, "173643": 47, "088662": 47, "105848": 47, "75": 47, "6628": 47, "idea": 48, "10x": 48, "speedup": 48, "subset": [48, 49], "experi": 48, "distutil": 48, "strtobool": 48, "pathlib": 48, "tqdm": 48, "num_work": 48, "environ": 48, "val": 48, "compon": [48, 51], "prevent": 48, "overfit": 48, "train_transform": 48, "compos": 48, "randomresizedcrop": 48, "224": 48, "randomhorizontalflip": 48, "485": 48, "456": 48, "406": 48, "229": 48, "225": 48, "val_transform": 48, "resiz": 48, "centercrop": 48, "imagefold": 48, "data_dir": 48, "hymenoptera_data": 48, "train_data": 48, "val_data": 48, "yet": 48, "train_data_raw": 48, "piltotensor": 48, "vector": [48, 52], "invaffin": 48, "crop": 48, "flip": 48, "randomhflip": 48, "bernoulli_": 48, "expand_a": 48, "randomcrop": 48, "index0": 48, "index1": 48, "principl": 48, "signific": 48, "collate_transform": 48, "255": 48, "known": 48, "apriori": 48, "add": [48, 49], "imagenetdata": 48, "dl": 48, "pbar": 48, "_batch": 48, "train_data_tc": 48, "val_data_tc": 48, "244": 48, "78": 48, "63it": 48, "160": 48, "89it": 48, "249": 48, "153": 48, "92": 48, "33it": 48, "84": 48, "171": 48, "50it": 48, "helper": 48, "gpu": 48, "parallel": 48, "essenti": 48, "But": 48, "val_dataload": 48, "val_dataloader_tc": 48, "measur": 48, "rate": 48, "fp": 48, "300": 48, "3467": 48, "7325": 48, "632": 48, "5110": 48, "3478": 48, "bigger": 48, "improv": 48, "fulli": 48, "258": 48, "2552": 48, "4995": 48, "9035": 48, "2217": 48, "0143": 48, "aw": 48, "ec2": 48, "core": 48, "a100": 48, "against": 48, "thread": 48, "larg": [48, 49, 54], "o": 48, "explain": 48, "about": 48, "chart": 48, "better": 48, "ad": [48, 49], "author": [49, 50, 53, 54, 55], "tom": [49, 50, 53, 54, 55], "beglei": [49, 50, 53, 54, 55], "accomplish": 49, "request": 49, "banana": 49, "statement": 49, "chosen": 49, "furthermor": 49, "nested_tensordict": 49, "double_nest": 49, "double_nested_a": 49, "nested_a": 49, "top": 49, "lookup": 49, "neg": [49, 54], "flattened_tensordict": 49, "particularli": 49, "meth": 49, "omit": 49, "clear_devic": 50, "imagenet": 50, "slowli": 50, "mm_tensordict": 50, "numpi": 50, "metadata": 50, "associ": [50, 51], "a_out": 51, "averag": 51, "mergelinear": 51, "in_1": [51, 52], "in_2": 51, "linear_1": [51, 52], "linear_2": [51, 52], "x_1": 51, "x_2": 51, "multiheadlinear": [51, 52], "out_1": [51, 52], "out_2": [51, 52], "splitlinear": [51, 52], "output_1": [51, 52], "output_2": [51, 52], "split_and_merge_linear": 51, "variabl": 51, "ok": 51, "exploration_mod": 51, "conflict": 51, "preced": 51, "wire": 51, "termin": 51, "extractor": 51, "figur": 51, "classic": 51, "architectur": 51, "vaswani": 51, "et": 51, "al": 51, "2017": 51, "posit": 51, "encod": 51, "asid": 51, "simplic": 51, "tokenstoqkv": 51, "to_dim": 51, "from_dim": 51, "latent_dim": 51, "q": 51, "x_to": 51, "x_from": 51, "splithead": 51, "num_head": 51, "to_num": 51, "from_num": 51, "d_tensor": 51, "attent": 51, "n_head": 51, "d_in": 51, "attn": 51, "skiplayernorm": 51, "to_len": 51, "layer_norm": 51, "layernorm": 51, "x_0": 51, "ffn": 51, "hidden_dim": 51, "dropout_r": 51, "dropout": 51, "attentionblock": 51, "tokens_to_qkv": 51, "split_head": 51, "encodertransformerblock": 51, "attention_block": 51, "x_out": 51, "decodertransformerblock": 51, "encoder_block": 51, "transformerencod": 51, "num_block": 51, "decod": 51, "from_len": 51, "attentionblocktensordict": 51, "connect": 51, "to_nam": 51, "from_nam": 51, "thank": 51, "transformerblockencodertensordict": 51, "transformerblockdecodertensordict": 51, "token": 51, "info": 51, "transformerencodertensordict": 51, "transformerdecodertensordict": 51, "transformertensordict": 51, "x_encod": 51, "x_decod": 51, "operar": 51, "td_token": 51, "tdtransform": 51, "t1": 51, "t2": 51, "02085399627685547": 51, "t3": 51, "t4": 51, "01199960708618164": 51, "minim": 51, "introduc": 51, "functionl": 52, "reintroduc": 52, "ordinarili": 52, "make_functional_with_buff": 52, "functionalis": 52, "func": 52, "replica": 52, "params_expand": 52, "buffers_expand": 52, "nativ": 52, "num_model": 52, "result_td": 52, "make_tensordict": 53, "perhap": 53, "initialis": 53, "prepopul": 53, "row": [53, 55], "random_tensordict": 53, "agre": [54, 55], "indexed_tensordict": 54, "reshaped_tensordict": 54, "assert_allclos": 54, "interpret": 54, "throughout": 54, "replac": 54, "conceptu": 54, "demand": 54, "cloned_tensordict": 54, "stacked_tensordict": 54, "recov": 54, "concatenated_tensordict": 54, "exp_tensordict": 54, "_squeezedtensordict": 54, "_unsqueezedtensordict": 54, "squeezed_tensordict": 54, "unsqueezed_tensordict": 54, "benefici": 54, "bear": 54, "ever": 54, "unaffect": 54, "drop": [54, 55], "_viewedtensordict": 54, "viewed_tensordict": 54, "untouch": 54, "permuted_tensordict": 54, "gathered_tensordict": 54, "8381": 54, "3672": 54, "4244": 54, "8379": 54, "8442": 54, "0137": 54, "5477": 54, "4296": 54, "0155": 54, "9893": 54, "9724": 54, "4611": 54, "discuss": 55, "simultan": 55, "new_tensordict": 55, "booltensor": 55, "That": 55, "doesn": 55, "orgiin": 55}, "objects": {"tensordict": [[4, 0, 1, "", "LazyStackedTensorDict"], [5, 0, 1, "", "MemmapTensor"], [6, 0, 1, "", "PersistentTensorDict"], [7, 0, 1, "", "SubTensorDict"], [8, 0, 1, "", "TensorDict"], [9, 0, 1, "", "dense_stack_tds"], [10, 0, 1, "", "is_batchedtensor"], [11, 0, 1, "", "is_memmap"], [12, 0, 1, "", "is_tensor_collection"], [13, 0, 1, "", "make_tensordict"], [14, 0, 1, "", "merge_tensordicts"], [33, 0, 1, "", "pad"], [34, 0, 1, "", "pad_sequence"]], "tensordict.LazyStackedTensorDict": [[4, 1, 1, "", "all"], [4, 1, 1, "", "any"], [4, 1, 1, "", "append"], [4, 1, 1, "", "apply"], [4, 1, 1, "", "apply_"], [4, 1, 1, "", "as_tensor"], [4, 2, 1, "", "batch_dims"], [4, 2, 1, "", "batch_size"], [4, 1, 1, "", "bfloat16"], [4, 1, 1, "", "bool"], [4, 1, 1, "", "chunk"], [4, 1, 1, "", "clear"], [4, 1, 1, "", "clear_device_"], [4, 1, 1, "", "clone"], [4, 1, 1, "", "contiguous"], [4, 1, 1, "", "copy_"], [4, 1, 1, "", "copy_at_"], [4, 1, 1, "", "cpu"], [4, 1, 1, "", "create_nested"], [4, 1, 1, "", "cuda"], [4, 1, 1, "", "del_"], [4, 1, 1, "", "detach"], [4, 1, 1, "", "detach_"], [4, 2, 1, "", "device"], [4, 1, 1, "", "double"], [4, 1, 1, "", "empty"], [4, 1, 1, "", "entry_class"], [4, 1, 1, "", "expand"], [4, 1, 1, "", "fill_"], [4, 1, 1, "", "flatten"], [4, 1, 1, "", "float"], [4, 1, 1, "", "from_module"], [4, 1, 1, "", "gather"], [4, 1, 1, "", "gather_and_stack"], [4, 1, 1, "", "get"], [4, 1, 1, "", "get_at"], [4, 1, 1, "", "get_item_shape"], [4, 1, 1, "", "get_nestedtensor"], [4, 1, 1, "", "get_sub_tensordict"], [4, 1, 1, "", "half"], [4, 1, 1, "", "insert"], [4, 1, 1, "", "int"], [4, 1, 1, "", "irecv"], [4, 1, 1, "", "is_contiguous"], [4, 1, 1, "", "is_memmap"], [4, 1, 1, "", "is_shared"], [4, 1, 1, "", "isend"], [4, 1, 1, "", "items"], [4, 1, 1, "", "keys"], [4, 1, 1, "", "masked_fill"], [4, 1, 1, "", "masked_fill_"], [4, 1, 1, "", "masked_select"], [4, 1, 1, "", "memmap_"], [4, 1, 1, "", "memmap_like"], [4, 1, 1, "", "numel"], [4, 1, 1, "", "permute"], [4, 1, 1, "", "pin_memory"], [4, 1, 1, "", "pop"], [4, 1, 1, "", "popitem"], [4, 1, 1, "", "recv"], [4, 1, 1, "", "reduce"], [4, 1, 1, "", "refine_names"], [4, 1, 1, "", "rename_key_"], [4, 1, 1, "", "reshape"], [4, 1, 1, "", "select"], [4, 1, 1, "", "send"], [4, 1, 1, "", "set"], [4, 1, 1, "", "set_"], [4, 1, 1, "", "set_at_"], [4, 1, 1, "", "setdefault"], [4, 2, 1, "", "shape"], [4, 1, 1, "", "share_memory_"], [4, 1, 1, "", "size"], [4, 2, 1, "", "sorted_keys"], [4, 1, 1, "", "split"], [4, 1, 1, "", "squeeze"], [4, 1, 1, "", "to"], [4, 1, 1, "", "to_dict"], [4, 1, 1, "", "to_h5"], [4, 1, 1, "", "to_tensordict"], [4, 1, 1, "", "transpose"], [4, 1, 1, "", "type"], [4, 1, 1, "", "unbind"], [4, 1, 1, "", "unflatten"], [4, 1, 1, "", "unsqueeze"], [4, 1, 1, "", "update"], [4, 1, 1, "", "update_"], [4, 1, 1, "", "update_at_"], [4, 1, 1, "", "valid_keys"], [4, 1, 1, "", "values"], [4, 1, 1, "", "view"], [4, 1, 1, "", "zero_"]], "tensordict.MemmapTensor": [[5, 1, 1, "", "as_tensor"], [5, 1, 1, "", "clone"], [5, 1, 1, "", "contiguous"], [5, 1, 1, "", "cpu"], [5, 1, 1, "", "cuda"], [5, 1, 1, "", "set_transfer_ownership"], [5, 1, 1, "", "to"], [5, 1, 1, "", "unbind"]], "tensordict.PersistentTensorDict": [[6, 1, 1, "", "all"], [6, 1, 1, "", "any"], [6, 1, 1, "", "apply"], [6, 1, 1, "", "apply_"], [6, 1, 1, "", "as_tensor"], [6, 2, 1, "", "batch_dims"], [6, 2, 1, "", "batch_size"], [6, 1, 1, "", "bfloat16"], [6, 1, 1, "", "bool"], [6, 1, 1, "", "chunk"], [6, 1, 1, "", "clear"], [6, 1, 1, "", "clear_device_"], [6, 1, 1, "", "clone"], [6, 1, 1, "", "close"], [6, 1, 1, "", "contiguous"], [6, 1, 1, "", "copy_"], [6, 1, 1, "", "copy_at_"], [6, 1, 1, "", "cpu"], [6, 1, 1, "", "create_nested"], [6, 1, 1, "", "cuda"], [6, 1, 1, "", "del_"], [6, 1, 1, "", "detach"], [6, 1, 1, "", "detach_"], [6, 2, 1, "", "device"], [6, 1, 1, "", "double"], [6, 1, 1, "", "empty"], [6, 1, 1, "", "entry_class"], [6, 1, 1, "", "expand"], [6, 1, 1, "", "fill_"], [6, 1, 1, "", "flatten"], [6, 1, 1, "", "float"], [6, 1, 1, "", "from_dict"], [6, 1, 1, "", "from_h5"], [6, 1, 1, "", "from_module"], [6, 1, 1, "", "gather"], [6, 1, 1, "", "gather_and_stack"], [6, 1, 1, "", "get"], [6, 1, 1, "", "get_at"], [6, 1, 1, "", "get_item_shape"], [6, 1, 1, "", "get_sub_tensordict"], [6, 1, 1, "", "half"], [6, 1, 1, "", "int"], [6, 1, 1, "", "irecv"], [6, 1, 1, "", "is_contiguous"], [6, 1, 1, "", "is_memmap"], [6, 1, 1, "", "is_shared"], [6, 1, 1, "", "isend"], [6, 1, 1, "", "items"], [6, 1, 1, "", "keys"], [6, 1, 1, "", "masked_fill"], [6, 1, 1, "", "masked_fill_"], [6, 1, 1, "", "masked_select"], [6, 1, 1, "", "memmap"], [6, 1, 1, "", "memmap_"], [6, 1, 1, "", "memmap_like"], [6, 1, 1, "", "numel"], [6, 1, 1, "", "permute"], [6, 1, 1, "", "pin_memory"], [6, 1, 1, "", "pop"], [6, 1, 1, "", "popitem"], [6, 1, 1, "", "recv"], [6, 1, 1, "", "reduce"], [6, 1, 1, "", "refine_names"], [6, 1, 1, "", "rename_key_"], [6, 1, 1, "", "reshape"], [6, 1, 1, "", "select"], [6, 1, 1, "", "send"], [6, 1, 1, "", "set"], [6, 1, 1, "", "set_"], [6, 1, 1, "", "set_at_"], [6, 1, 1, "", "setdefault"], [6, 2, 1, "", "shape"], [6, 1, 1, "", "share_memory_"], [6, 1, 1, "", "size"], [6, 2, 1, "", "sorted_keys"], [6, 1, 1, "", "split"], [6, 1, 1, "", "squeeze"], [6, 1, 1, "", "to"], [6, 1, 1, "", "to_dict"], [6, 1, 1, "", "to_h5"], [6, 1, 1, "", "to_tensordict"], [6, 1, 1, "", "transpose"], [6, 1, 1, "", "type"], [6, 1, 1, "", "unbind"], [6, 1, 1, "", "unflatten"], [6, 1, 1, "", "unsqueeze"], [6, 1, 1, "", "update"], [6, 1, 1, "", "update_"], [6, 1, 1, "", "update_at_"], [6, 1, 1, "", "values"], [6, 1, 1, "", "view"], [6, 1, 1, "", "zero_"]], "tensordict.SubTensorDict": [[7, 1, 1, "", "all"], [7, 1, 1, "", "any"], [7, 1, 1, "", "apply"], [7, 1, 1, "", "apply_"], [7, 1, 1, "", "as_tensor"], [7, 2, 1, "", "batch_dims"], [7, 2, 1, "", "batch_size"], [7, 1, 1, "", "bfloat16"], [7, 1, 1, "", "bool"], [7, 1, 1, "", "chunk"], [7, 1, 1, "", "clear"], [7, 1, 1, "", "clear_device_"], [7, 1, 1, "", "clone"], [7, 1, 1, "", "contiguous"], [7, 1, 1, "", "copy_"], [7, 1, 1, "", "copy_at_"], [7, 1, 1, "", "cpu"], [7, 1, 1, "", "create_nested"], [7, 1, 1, "", "cuda"], [7, 1, 1, "", "del_"], [7, 1, 1, "", "detach"], [7, 1, 1, "", "detach_"], [7, 2, 1, "", "device"], [7, 1, 1, "", "double"], [7, 1, 1, "", "empty"], [7, 1, 1, "", "entry_class"], [7, 1, 1, "", "expand"], [7, 1, 1, "", "fill_"], [7, 1, 1, "", "flatten"], [7, 1, 1, "", "float"], [7, 1, 1, "", "from_module"], [7, 1, 1, "", "gather"], [7, 1, 1, "", "gather_and_stack"], [7, 1, 1, "", "get"], [7, 1, 1, "", "get_at"], [7, 1, 1, "", "get_item_shape"], [7, 1, 1, "", "get_sub_tensordict"], [7, 1, 1, "", "half"], [7, 1, 1, "", "int"], [7, 1, 1, "", "irecv"], [7, 1, 1, "", "is_contiguous"], [7, 1, 1, "", "is_memmap"], [7, 1, 1, "", "is_shared"], [7, 1, 1, "", "isend"], [7, 1, 1, "", "items"], [7, 1, 1, "", "keys"], [7, 1, 1, "", "masked_fill"], [7, 1, 1, "", "masked_fill_"], [7, 1, 1, "", "masked_select"], [7, 1, 1, "", "memmap_"], [7, 1, 1, "", "memmap_like"], [7, 1, 1, "", "numel"], [7, 1, 1, "", "permute"], [7, 1, 1, "", "pin_memory"], [7, 1, 1, "", "pop"], [7, 1, 1, "", "popitem"], [7, 1, 1, "", "recv"], [7, 1, 1, "", "reduce"], [7, 1, 1, "", "refine_names"], [7, 1, 1, "", "rename_key_"], [7, 1, 1, "", "reshape"], [7, 1, 1, "", "select"], [7, 1, 1, "", "send"], [7, 1, 1, "", "set"], [7, 1, 1, "", "set_"], [7, 1, 1, "", "set_at_"], [7, 1, 1, "", "setdefault"], [7, 2, 1, "", "shape"], [7, 1, 1, "", "share_memory_"], [7, 1, 1, "", "size"], [7, 2, 1, "", "sorted_keys"], [7, 1, 1, "", "split"], [7, 1, 1, "", "squeeze"], [7, 1, 1, "", "to"], [7, 1, 1, "", "to_dict"], [7, 1, 1, "", "to_h5"], [7, 1, 1, "", "to_tensordict"], [7, 1, 1, "", "transpose"], [7, 1, 1, "", "type"], [7, 1, 1, "", "unbind"], [7, 1, 1, "", "unflatten"], [7, 1, 1, "", "unsqueeze"], [7, 1, 1, "", "update"], [7, 1, 1, "", "update_"], [7, 1, 1, "", "update_at_"], [7, 1, 1, "", "values"], [7, 1, 1, "", "view"], [7, 1, 1, "", "zero_"]], "tensordict.TensorDict": [[8, 1, 1, "", "all"], [8, 1, 1, "", "any"], [8, 1, 1, "", "apply"], [8, 1, 1, "", "apply_"], [8, 1, 1, "", "as_tensor"], [8, 2, 1, "", "batch_dims"], [8, 2, 1, "", "batch_size"], [8, 1, 1, "", "bfloat16"], [8, 1, 1, "", "bool"], [8, 1, 1, "", "chunk"], [8, 1, 1, "", "clear"], [8, 1, 1, "", "clear_device_"], [8, 1, 1, "", "clone"], [8, 1, 1, "", "contiguous"], [8, 1, 1, "", "copy_"], [8, 1, 1, "", "copy_at_"], [8, 1, 1, "", "cpu"], [8, 1, 1, "", "create_nested"], [8, 1, 1, "", "cuda"], [8, 1, 1, "", "del_"], [8, 1, 1, "", "detach"], [8, 1, 1, "", "detach_"], [8, 2, 1, "", "device"], [8, 1, 1, "", "double"], [8, 1, 1, "", "empty"], [8, 1, 1, "", "entry_class"], [8, 1, 1, "", "expand"], [8, 1, 1, "", "fill_"], [8, 1, 1, "", "flatten"], [8, 1, 1, "", "float"], [8, 1, 1, "", "from_dict"], [8, 1, 1, "", "from_module"], [8, 1, 1, "", "gather"], [8, 1, 1, "", "gather_and_stack"], [8, 1, 1, "", "get"], [8, 1, 1, "", "get_at"], [8, 1, 1, "", "get_item_shape"], [8, 1, 1, "", "get_sub_tensordict"], [8, 1, 1, "", "half"], [8, 1, 1, "", "int"], [8, 1, 1, "", "irecv"], [8, 1, 1, "", "is_contiguous"], [8, 1, 1, "", "is_memmap"], [8, 1, 1, "", "is_shared"], [8, 1, 1, "", "isend"], [8, 1, 1, "", "items"], [8, 1, 1, "", "keys"], [8, 1, 1, "", "masked_fill"], [8, 1, 1, "", "masked_fill_"], [8, 1, 1, "", "masked_select"], [8, 1, 1, "", "memmap_"], [8, 1, 1, "", "memmap_like"], [8, 1, 1, "", "numel"], [8, 1, 1, "", "permute"], [8, 1, 1, "", "pin_memory"], [8, 1, 1, "", "pop"], [8, 1, 1, "", "popitem"], [8, 1, 1, "", "recv"], [8, 1, 1, "", "reduce"], [8, 1, 1, "", "refine_names"], [8, 1, 1, "", "rename_key_"], [8, 1, 1, "", "reshape"], [8, 1, 1, "", "select"], [8, 1, 1, "", "send"], [8, 1, 1, "", "set"], [8, 1, 1, "", "set_"], [8, 1, 1, "", "set_at_"], [8, 1, 1, "", "setdefault"], [8, 2, 1, "", "shape"], [8, 1, 1, "", "share_memory_"], [8, 1, 1, "", "size"], [8, 2, 1, "", "sorted_keys"], [8, 1, 1, "", "split"], [8, 1, 1, "", "squeeze"], [8, 1, 1, "", "to"], [8, 1, 1, "", "to_dict"], [8, 1, 1, "", "to_h5"], [8, 1, 1, "", "to_tensordict"], [8, 1, 1, "", "transpose"], [8, 1, 1, "", "type"], [8, 1, 1, "", "unbind"], [8, 1, 1, "", "unflatten"], [8, 1, 1, "", "unsqueeze"], [8, 1, 1, "", "update"], [8, 1, 1, "", "update_"], [8, 1, 1, "", "update_at_"], [8, 1, 1, "", "values"], [8, 1, 1, "", "view"], [8, 1, 1, "", "zero_"]], "tensordict.nn": [[15, 0, 1, "", "EnsembleModule"], [16, 0, 1, "", "ProbabilisticTensorDictModule"], [17, 0, 1, "", "TensorDictModule"], [18, 0, 1, "", "TensorDictModuleBase"], [19, 0, 1, "", "TensorDictModuleWrapper"], [20, 0, 1, "", "TensorDictParams"], [21, 0, 1, "", "TensorDictSequential"], [22, 0, 1, "", "biased_softplus"], [23, 0, 1, "", "dispatch"], [24, 3, 1, "", "get_functional"], [25, 3, 1, "", "inv_softplus"], [26, 3, 1, "", "is_functional"], [27, 3, 1, "", "make_functional"], [28, 3, 1, "", "make_tensordict"], [29, 3, 1, "", "repopulate_module"], [30, 0, 1, "", "set_interaction_type"], [31, 0, 1, "", "set_skip_existing"], [32, 3, 1, "", "skip_existing"]], "tensordict.nn.ProbabilisticTensorDictModule": [[16, 1, 1, "", "forward"]], "tensordict.nn.TensorDictModule": [[17, 1, 1, "", "forward"]], "tensordict.nn.TensorDictModuleBase": [[18, 1, 1, "", "reset_out_keys"], [18, 1, 1, "", "reset_parameters_recursive"], [18, 1, 1, "", "select_out_keys"]], "tensordict.nn.TensorDictModuleWrapper": [[19, 1, 1, "", "forward"]], "tensordict.nn.TensorDictSequential": [[21, 1, 1, "", "forward"], [21, 1, 1, "", "select_subsequence"]], "tensordict.prototype": [[35, 3, 1, "", "symbolic_trace"]], "tensordict.utils": [[36, 0, 1, "", "expand_as_right"], [37, 0, 1, "", "expand_right"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:property", "3": "py:function"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "property", "Python property"], "3": ["py", "function", "Python function"]}, "titleterms": {"tensordict": [0, 2, 3, 8, 15, 20, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 35, 40, 42, 43, 44, 49, 50, 53, 54], "distribut": 0, "set": [0, 49, 55], "creat": 0, "memori": [0, 42, 43, 50, 53], "map": [0, 42, 43, 50], "oper": 0, "tensor": [0, 42, 50], "across": 0, "node": 0, "trace": [1, 40], "tensordictmodul": [1, 3, 17, 51, 52], "tensordictsequenti": [1, 21, 51], "welcom": 2, "document": 2, "tutori": 2, "basic": 2, "nn": [2, 15, 20, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 40], "dataload": [2, 44, 47, 48], "content": [2, 49], "indic": 2, "tabl": 2, "overview": 3, "motiv": 3, "featur": 3, "name": 3, "dimens": [3, 54], "nest": [3, 49], "lazi": 3, "evalu": 3, "pre": [3, 53], "alloc": [3, 53], "function": [3, 40, 52], "program": 3, "lazystackedtensordict": 4, "memmaptensor": [5, 43], "persistenttensordict": 6, "subtensordict": [7, 55], "dense_stack_td": 9, "is_batchedtensor": 10, "is_memmap": 11, "is_tensor_collect": 12, "make_tensordict": [13, 28], "merge_tensordict": 14, "ensemblemodul": 15, "probabilistictensordictmodul": [16, 51], "tensordictmodulebas": 18, "tensordictmodulewrapp": 19, "tensordictparam": 20, "biased_softplu": 22, "dispatch": 23, "get_funct": 24, "inv_softplu": 25, "is_funct": 26, "make_funct": 27, "repopulate_modul": 29, "set_interaction_typ": 30, "set_skip_exist": 31, "skip_exist": 32, "pad": 33, "pad_sequ": 34, "prototyp": [35, 41], "symbolic_trac": 35, "expand_as_right": 36, "expand_right": 37, "readm": [38, 45], "tuto": [38, 45], "api": 39, "refer": 39, "packag": [40, 42], "ensembl": 40, "compil": 40, "util": [40, 42], "tensorclass": [41, 43, 47, 48], "edg": 41, "case": [41, 43], "save": 43, "object": 43, "gener": 43, "us": [43, 44, 47, 51], "load": [43, 48], "big": 43, "dataset": [43, 44, 47], "memmori": 43, "handl": 43, "exist": [43, 49], "model": [44, 47], "optim": [44, 47], "paramet": [44, 47], "comput": 46, "time": 46, "batch": [48, 54], "data": 48, "transform": [48, 51], "repres": 48, "result": 48, "from": 48, "imagenet": 48, "manipul": [49, 54], "kei": 49, "get": 49, "renam": 49, "updat": 49, "multipl": [49, 51], "valu": [49, 54, 55], "iter": 49, "over": 49, "s": [49, 51], "check": 49, "flatten": 49, "unflatten": 49, "select": 49, "exclud": 49, "simplifi": 50, "pytorch": 50, "manag": 50, "devic": 50, "exampl": 51, "1": 51, "simpl": 51, "usag": 51, "2": 51, "input": 51, "3": 51, "output": 51, "4": 51, "combin": 51, "do": 51, "don": 51, "t": 51, "showcas": 51, "implement": 51, "benchmark": 51, "shape": 54, "index": [54, 55], "reshap": 54, "split": 54, "unbind": 54, "stack": 54, "concaten": 54, "expand": 54, "squeez": 54, "unsqueez": 54, "view": 54, "permut": 54, "gather": 54, "slice": 55, "mask": 55}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})